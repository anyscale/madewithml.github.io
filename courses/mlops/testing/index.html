
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Learn how to test ML artifacts (code, data and models) to ensure a reliable ML system.">
      
      
        <meta name="author" content="Goku Mohandas">
      
      
        <link rel="canonical" href="https://madewithml.com/courses/mlops/testing/">
      
      
        <link rel="prev" href="../pre-commit/">
      
      
        <link rel="next" href="../versioning/">
      
      <link rel="icon" href="../../../favicon.ico">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.18">
    
    
      
        <title>Testing Machine Learning Systems: Code, Data and Models - Made With ML by Anyscale</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Epilogue:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Epilogue";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../static/scss/extra.css">
    
      <link rel="stylesheet" href="../../../static/scss/bs.css">
    
      <link rel="stylesheet" href="../../../static/scss/termynal.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    

  <!-- Set title -->
  
  
    
  

  <!-- Set description -->
  
  
    
  

  <!-- Set image -->
  
  
    
  

  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Testing Machine Learning Systems: Code, Data and Models - Made With ML by Anyscale" />
  <meta property="og:description" content="Learn how to test ML artifacts (code, data and models) to ensure a reliable ML system." />
  <meta property="og:url" content="https://madewithml.com/courses/mlops/testing/" />
  <meta property="og:image" content="https://madewithml.com/static/images/mlops.png" />
  <meta property="og:image:type" content="image/png" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@GokuMohandas" />
  <meta name="twitter:creator" content="@GokuMohandas" />
  <meta name="twitter:title" content="Testing Machine Learning Systems: Code, Data and Models - Made With ML by Anyscale" />
  <meta name="twitter:description" content="Learn how to test ML artifacts (code, data and models) to ensure a reliable ML system." />
  <meta name="twitter:image" content="https://madewithml.com/static/images/mlops.png" />

  <!-- GTM Container -->
  <script>
    (function (w, d, s, l, i) {
      w[l] = w[l] || [];
      w[l].push({
        "gtm.start": new Date().getTime(),
        event: "gtm.js",
      });
      var f = d.getElementsByTagName(s)[0],
        j = d.createElement(s),
        dl = l != "dataLayer" ? "&l=" + l : "";
      j.async = true;
      j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
      f.parentNode.insertBefore(j, f);
    })(window, document, "script", "dataLayer", "GTM-P8H6KQG");
  </script>

  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#intuition" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            
<div class="ai-announce">
  Try Ray with $100 credit ‚Äî <a href="https://console.anyscale.com/register/ha?utm_source=made_with_ml&utm_medium=website&utm_campaign=banner" target="_blank" class="ai-announce-link">Start Now</a>
</div>

          </div>
          
        </aside>
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Made With ML by Anyscale" class="md-header__button md-logo" aria-label="Made With ML by Anyscale" data-md-component="logo">
      
  <img src="../../../static/images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Made With ML by Anyscale
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Testing Machine Learning Systems: Code, Data and Models
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/GokuMohandas/Made-With-ML" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GokuMohandas/MadeWithML
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../about/" class="md-tabs__link">
      About
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="/#course" class="md-tabs__link md-tabs__link--active">
        Course
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="/courses/foundations/" class="md-tabs__link">
        Foundations
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../misc/newsletter/" class="md-tabs__link">
      Subscribe
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="https://discord.com/channels/1078171187609337896/1078171189169635472" class="md-tabs__link">
      Community
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Made With ML by Anyscale" class="md-nav__button md-logo" aria-label="Made With ML by Anyscale" data-md-component="logo">
      
  <img src="../../../static/images/logo.png" alt="logo">

    </a>
    Made With ML by Anyscale
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/GokuMohandas/Made-With-ML" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GokuMohandas/MadeWithML
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../about/" class="md-nav__link">
        About
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Course
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Course
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/#course" class="md-nav__link">
        Lessons
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
      
      
      
        <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
          üé® &nbsp; Design
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          üé® &nbsp; Design
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setup/" class="md-nav__link">
        Setup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../product-design/" class="md-nav__link">
        Product
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../systems-design/" class="md-nav__link">
        Systems
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
          üî¢ &nbsp; Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          üî¢ &nbsp; Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../preparation/" class="md-nav__link">
        Preparation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../exploratory-data-analysis/" class="md-nav__link">
        Exploration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../preprocessing/" class="md-nav__link">
        Preprocessing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../distributed-data/" class="md-nav__link">
        Distributed
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
      
      
      
        <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
          üìà &nbsp; Model
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          üìà &nbsp; Model
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../training/" class="md-nav__link">
        Training
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../experiment-tracking/" class="md-nav__link">
        Tracking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tuning/" class="md-nav__link">
        Tuning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../evaluation/" class="md-nav__link">
        Evaluation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../serving/" class="md-nav__link">
        Serving
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
      
      
      
        <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
          üíª &nbsp; Developing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_5">
          <span class="md-nav__icon md-icon"></span>
          üíª &nbsp; Developing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../scripting/" class="md-nav__link">
        Scripting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        CLI
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
      
      
      
        <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
          üì¶ &nbsp; Utilities
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_6">
          <span class="md-nav__icon md-icon"></span>
          üì¶ &nbsp; Utilities
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../logging/" class="md-nav__link">
        Logging
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../documentation/" class="md-nav__link">
        Documentation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../styling/" class="md-nav__link">
        Styling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pre-commit/" class="md-nav__link">
        Pre-commit
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
          ‚úÖ &nbsp; Testing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3_7">
          <span class="md-nav__icon md-icon"></span>
          ‚úÖ &nbsp; Testing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Code
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Code
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#intuition" class="md-nav__link">
    Intuition
  </a>
  
    <nav class="md-nav" aria-label="Intuition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#types-of-tests" class="md-nav__link">
    Types of tests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-should-we-test" class="md-nav__link">
    How should we test?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-should-we-test" class="md-nav__link">
    What should we test?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    Best practices
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation" class="md-nav__link">
    Implementation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code" class="md-nav__link">
    üíª&nbsp; Code
  </a>
  
    <nav class="md-nav" aria-label="üíª¬† Code">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    Configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#assertions" class="md-nav__link">
    Assertions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#execution" class="md-nav__link">
    Execution
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    Classes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parametrize" class="md-nav__link">
    Parametrize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fixtures" class="md-nav__link">
    Fixtures
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#markers" class="md-nav__link">
    Markers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coverage" class="md-nav__link">
    Coverage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exclusions" class="md-nav__link">
    Exclusions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data" class="md-nav__link">
    üî¢&nbsp; Data
  </a>
  
    <nav class="md-nav" aria-label="üî¢¬† Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#expectations" class="md-nav__link">
    Expectations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#suite" class="md-nav__link">
    Suite
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#production" class="md-nav__link">
    Production
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models" class="md-nav__link">
    ü§ñ&nbsp; Models
  </a>
  
    <nav class="md-nav" aria-label="ü§ñ¬† Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#training" class="md-nav__link">
    Training
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioral-testing" class="md-nav__link">
    Behavioral testing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-vs-monitoring" class="md-nav__link">
    Testing vs. monitoring
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources" class="md-nav__link">
    Resources
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="#data" class="md-nav__link">
        Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="#models" class="md-nav__link">
        Models
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8" >
      
      
      
        <label class="md-nav__link" for="__nav_3_8" id="__nav_3_8_label" tabindex="0">
          ‚ôªÔ∏è &nbsp; Reproducibility
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_8">
          <span class="md-nav__icon md-icon"></span>
          ‚ôªÔ∏è &nbsp; Reproducibility
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../versioning/" class="md-nav__link">
        Versioning
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_9" >
      
      
      
        <label class="md-nav__link" for="__nav_3_9" id="__nav_3_9_label" tabindex="0">
          üöÄ &nbsp; Production
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_9">
          <span class="md-nav__icon md-icon"></span>
          üöÄ &nbsp; Production
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jobs-and-services/" class="md-nav__link">
        Jobs & Services
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cicd/" class="md-nav__link">
        CI/CD workflows
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../monitoring/" class="md-nav__link">
        Monitoring
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data-engineering/" class="md-nav__link">
        Data engineering
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Foundations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Foundations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/courses/foundations/" class="md-nav__link">
        Lessons
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
      
      
      
        <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
          üõ† &nbsp; Toolkit
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          üõ† &nbsp; Toolkit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/notebooks/" class="md-nav__link">
        Notebooks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/python/" class="md-nav__link">
        Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/numpy/" class="md-nav__link">
        NumPy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/pandas/" class="md-nav__link">
        Pandas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/pytorch/" class="md-nav__link">
        PyTorch
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
      
      
      
        <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
          üî• &nbsp; Machine Learning
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          üî• &nbsp; Machine Learning
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/linear-regression/" class="md-nav__link">
        Linear regression
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/logistic-regression/" class="md-nav__link">
        Logistic regression
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/neural-networks/" class="md-nav__link">
        Neural networks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/data-quality/" class="md-nav__link">
        Data quality
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/utilities/" class="md-nav__link">
        Utilities
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
          ü§ñ &nbsp; Deep Learning
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          ü§ñ &nbsp; Deep Learning
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/convolutional-neural-networks/" class="md-nav__link">
        CNNs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/embeddings/" class="md-nav__link">
        Embeddings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/recurrent-neural-networks/" class="md-nav__link">
        RNNs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/attention/" class="md-nav__link">
        Attention
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/transformers/" class="md-nav__link">
        Transformers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../misc/newsletter/" class="md-nav__link">
        Subscribe
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://discord.com/channels/1078171187609337896/1078171189169635472" class="md-nav__link">
        Community
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#intuition" class="md-nav__link">
    Intuition
  </a>
  
    <nav class="md-nav" aria-label="Intuition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#types-of-tests" class="md-nav__link">
    Types of tests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-should-we-test" class="md-nav__link">
    How should we test?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-should-we-test" class="md-nav__link">
    What should we test?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    Best practices
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation" class="md-nav__link">
    Implementation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code" class="md-nav__link">
    üíª&nbsp; Code
  </a>
  
    <nav class="md-nav" aria-label="üíª¬† Code">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    Configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#assertions" class="md-nav__link">
    Assertions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#execution" class="md-nav__link">
    Execution
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    Classes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parametrize" class="md-nav__link">
    Parametrize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fixtures" class="md-nav__link">
    Fixtures
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#markers" class="md-nav__link">
    Markers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coverage" class="md-nav__link">
    Coverage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exclusions" class="md-nav__link">
    Exclusions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data" class="md-nav__link">
    üî¢&nbsp; Data
  </a>
  
    <nav class="md-nav" aria-label="üî¢¬† Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#expectations" class="md-nav__link">
    Expectations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#suite" class="md-nav__link">
    Suite
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#production" class="md-nav__link">
    Production
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models" class="md-nav__link">
    ü§ñ&nbsp; Models
  </a>
  
    <nav class="md-nav" aria-label="ü§ñ¬† Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#training" class="md-nav__link">
    Training
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioral-testing" class="md-nav__link">
    Behavioral testing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-vs-monitoring" class="md-nav__link">
    Testing vs. monitoring
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources" class="md-nav__link">
    Resources
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
  
  
    <div class="row">
      <div class="col-md-8">
        <h1 style="margin-bottom: 0.5rem;">Testing Machine Learning Systems: Code, Data and Models</h1>
      </div>
      <div class="col-md-4 ai-center-all order-first order-md-last mb-2 mb-md-0 mb-lg-0">
        <a href="/courses/mlops" class="mb-2">
          <span class="twemoji">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M7.78 12.53a.75.75 0 0 1-1.06 0L2.47 8.28a.75.75 0 0 1 0-1.06l4.25-4.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042L4.81 7h7.44a.75.75 0 0 1 0 1.5H4.81l2.97 2.97a.75.75 0 0 1 0 1.06Z"/></svg>
          </span> View all lessons</a>
      </div>
    </div>
    <hr class="mt-0 mt-md-2 mt-lg-2">
    <div class="row">
      <div class="col-md-8">
        
          <span>Learn how to test ML artifacts (code, data and models) to ensure a reliable ML system.</span>
        
      </div>
      <div class="col-md-4 order-first order-md-last">
        <div class="row mb-4 mb-md-0 mb-lg-0">
          <div class="col-md-3 col-2 ai-center-all" style="padding-right: 10px;">
            <img src="/static/images/goku_circle.png" style="width: 3rem; max-width: 120%;" alt="Goku Mohandas">
          </div>
          <div class="col-md-9 col-10" style="padding-left: 5px;">
            <div>Goku Mohandas</div>
            <div>
              <a href="https://twitter.com/GokuMohandas" target="_blank">
                <span class="twemoji twitter">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
                </span></a> &middot;
              <a href="https://linkedin.com/in/goku" target="_blank">
                <span class="twemoji linkedin">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
                </span></a> &middot;
              <a href="https://github.com/gokumohandas" target="_blank">
                <span class="twemoji github">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
                </span></a> &middot;
              <a href="https://www.youtube.com/c/MadeWithML" target="_blank">
                <span class="twemoji youtube">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
                </span></a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Links -->
    <div class="mt-1"></div>
    
      <span class="twemoji">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"/></svg>
      </span>
      <a href="https://github.com/GokuMohandas/Made-With-ML" target="_blank">Repository</a>
    
    
      <span> ¬∑ </span>
      <span class="twemoji">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 3.75A.75.75 0 0 1 .75 3h7.497c1.566 0 2.945.8 3.751 2.014A4.495 4.495 0 0 1 15.75 3h7.5a.75.75 0 0 1 .75.75v15.063a.752.752 0 0 1-.755.75l-7.682-.052a3 3 0 0 0-2.142.878l-.89.891a.75.75 0 0 1-1.061 0l-.902-.901a2.996 2.996 0 0 0-2.121-.879H.75a.75.75 0 0 1-.75-.75Zm12.75 15.232a4.503 4.503 0 0 1 2.823-.971l6.927.047V4.5h-6.75a3 3 0 0 0-3 3ZM11.247 7.497a3 3 0 0 0-3-2.997H1.5V18h6.947c1.018 0 2.006.346 2.803.98Z"/></svg>
      </span>
      <a href="https://github.com/GokuMohandas/testing-ml/blob/main/testing.ipynb" target="_blank">Notebook</a>
    
    
    

    <!-- Subscribe -->
    <!-- DON'T FORGET TO CHANGE LINK INSIDE index.html -->
<div class="modal fade" id="newsletterForm" tabindex="-1" role="dialog" aria-labelledby="newsletterFormLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header" style="padding: 0.5rem 1rem 0.5rem 1rem;">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <iframe width="540" height="600"
        src="https://c8efd03b.sibforms.com/serve/MUIFAKa3IQxVRvYHZ_oiARAblHq4WbNhDT72vx1pHJFklbHrp4V813O6mQMUHN5ikC51vZBBw2VqyEgMGgf6NFQg9rC8qgcURZBtzPj5TjOFimUAPyYPTLFrmd6nRKV0OK09SRnZxucZX0xMGR02ADg0GSvd_see2qS0VZnFPJ_JudrivA7uA4fs4BZrNn_3_fMjmF_Bj9ZOD9Ia"
        frameborder="0" scrolling="auto" allowfullscreen
        style="display: block;margin-left: auto;margin-right: auto;max-width: 100%;"></iframe>
    </div>
  </div>
</div>

<div class="admonition abstract" style="margin-top: 2rem;">
  <p class="admonition-title">Subscribe to our newsletter</p>
  <p>üì¨&nbsp; Receive new lessons straight to your inbox (once a month) and join <b>40K+</b>
    developers in learning how to responsibly deliver value with ML.</p>
  <div class="row">
    <div class="col-md-9">
      <input class="revue-form-field" placeholder="Work email" type="email" name="member[email]"
        id="member_email" style="width: 100%; height: 95%; border: 1px solid #b3b3b3; border-radius: 3px; font-size: 0.8rem;">
    </div>
    <div class="col-md-3 pl-md-0">
      <button class="md-button md-button--purple-gradient mt-md-0 mt-2" type="submit"
        style="cursor: pointer !important; height: 95%;" data-toggle="modal" data-target="#newsletterForm">Subscribe</button>
    </div>
  </div>
</div>
<hr style="margin-top: 2rem; margin-bottom: 2rem;">

  
  <style>
  .md-content {
    padding-left: 2.5rem;
    padding-right: 2.5rem;
  }

  /* Mobile */
  @media (max-width: 480px) {
    .md-content {
      padding-left: 0rem;
      padding-right: 0rem;
    }
  }

  /* Desktop */
  @media (min-width: 768px) {

    /* .md-nav--primary {
      display: none !important;
    } */
    .md-sidebar--primary {
      width: 9rem !important;
    }

    .md-sidebar--secondary {
      width: 9rem !important;
    }
  }
</style>

<h2 id="intuition">Intuition</h2>
<p>In this lesson, we'll learn how to test code, data and machine learning models to construct a machine learning system that we can reliably iterate on. Tests are a way for us to ensure that something works as intended. We're incentivized to implement tests and discover sources of error as early in the development cycle as possible so that we can decrease <a href="https://assets.deepsource.io/39ed384/images/blog/cost-of-fixing-bugs/chart.jpg" target="_blank">downstream costs</a> and wasted time. Once we've designed our tests, we can automatically execute them every time we change or add to our codebase.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>We highly recommend that you explore this lesson <em>after</em> completing the previous lessons since the topics (and code) are iteratively developed. We did, however, create the <span class="twemoji github"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span> <a href="https://github.com/GokuMohandas/testing-ml" target="_blank">testing-ml</a> repository for a quick overview with an interactive notebook.</p>
</div>
<h3 id="types-of-tests">Types of tests</h3>
<p>There are four majors types of tests which are utilized at different points in the development cycle:</p>
<ol>
<li><code class="highlight"><span class="nx">Unit</span><span class="w"> </span><span class="nx">tests</span></code>: tests on individual components that each have a <a href="https://en.wikipedia.org/wiki/Single-responsibility_principle" target="_blank">single responsibility</a> (ex. function that filters a list).</li>
<li><code class="highlight"><span class="nx">Integration</span><span class="w"> </span><span class="nx">tests</span></code>: tests on the combined functionality of individual components (ex. data processing).</li>
<li><code class="highlight"><span class="nx">System</span><span class="w"> </span><span class="nx">tests</span></code>: tests on the design of a system for expected outputs given inputs (ex. training, inference, etc.).</li>
<li><code class="highlight"><span class="nx">Acceptance</span><span class="w"> </span><span class="nx">tests</span></code>: tests to verify that requirements have been met, usually referred to as User Acceptance Testing (UAT).</li>
<li><code class="highlight"><span class="nx">Regression</span><span class="w"> </span><span class="nx">tests</span></code>: tests based on errors we've seen before to ensure new changes don't reintroduce them.</li>
</ol>
<p>While ML systems are probabilistic in nature, they are composed of many deterministic components that can be tested in a similar manner as traditional software systems. The distinction between testing ML systems begins when we move from testing code to testing the <a href="./#data" target="_blank">data</a> and <a href="./#models" target="_blank">models</a>.</p>
<div class="ai-center-all">
    <img width="700" src="/static/images/mlops/testing/tests.png" alt="types of tests">
</div>

<blockquote>
<p>There are many other types of functional and non-functional tests as well, such as smoke tests (quick health checks), performance tests (load, stress), security tests, etc. but we can generalize all of these under the system tests above.</p>
</blockquote>
<h3 id="how-should-we-test">How should we test?</h3>
<p>The framework to use when composing tests is the <a href="http://wiki.c2.com/?ArrangeActAssert" target="_blank">Arrange Act Assert</a> methodology.</p>
<ul>
<li><code class="highlight"><span class="nx">Arrange</span></code>: set up the different inputs to test on.</li>
<li><code class="highlight"><span class="nx">Act</span></code>: apply the inputs on the component we want to test.</li>
<li><code class="highlight"><span class="nx">Assert</span></code>: confirm that we received the expected output.</li>
</ul>
<blockquote>
<p><code class="highlight"><span class="nx">Cleaning</span></code> is an unofficial fourth step to this methodology because it's important to not leave remnants of a previous test which may affect subsequent tests. We can use packages such as <a href="https://github.com/pytest-dev/pytest-randomly" target="_blank">pytest-randomly</a> to test against state dependency by executing tests randomly.</p>
</blockquote>
<p>In Python, there are many tools, such as <a href="https://docs.python.org/3/library/unittest.html" target="_blank">unittest</a>, <a href="https://docs.pytest.org/en/stable/" target="_blank">pytest</a>, etc. that allow us to easily implement our tests while adhering to the <em>Arrange Act Assert</em> framework. These tools come with powerful built-in functionality such as parametrization, filters, and more, to test many conditions at scale.</p>
<h3 id="what-should-we-test">What should we test?</h3>
<p>When <em>arranging</em> our inputs and <em>asserting</em> our expected outputs, what are some aspects of our inputs and outputs that we should be testing for?</p>
<ul>
<li><strong>inputs</strong>: data types, format, length, edge cases (min/max, small/large, etc.)</li>
<li><strong>outputs</strong>: data types, formats, exceptions, intermediary and final outputs</li>
</ul>
<blockquote>
<p>üëâ &nbsp;We'll cover specific details pertaining to what to test for regarding our <a href="./#data">data</a> and <a href="./#models">models</a> below.</p>
</blockquote>
<h2 id="best-practices">Best practices</h2>
<p>Regardless of the framework we use, it's important to strongly tie testing into the development process.</p>
<ul>
<li><code class="highlight"><span class="nx">atomic</span></code>: when creating functions and classes, we need to ensure that they have a <a href="https://en.wikipedia.org/wiki/Single-responsibility_principle" target="_blank">single responsibility</a> so that we can easily test them. If not, we'll need to split them into more granular components.</li>
<li><code class="highlight"><span class="nx">compose</span></code>: when we create new components, we want to compose tests to validate their functionality. It's a great way to ensure reliability and catch errors early on.</li>
<li><code class="highlight"><span class="nx">reuse</span></code>: we should maintain central repositories where core functionality is tested at the source and reused across many projects. This significantly reduces testing efforts for each new project's code base.</li>
<li><code class="highlight"><span class="nx">regression</span></code>: we want to account for new errors we come across with a regression test so we can ensure we don't reintroduce the same errors in the future.</li>
<li><code class="highlight"><span class="nx">coverage</span></code>: we want to ensure <a href="#coverage">100% coverage</a> for our codebase. This doesn't mean writing a test for every single line of code but rather accounting for every single line.</li>
<li><code class="highlight"><span class="nx">automate</span></code>: in the event we forget to run our tests before committing to a repository, we want to auto run tests when we make changes to our codebase. We'll learn how to do this locally using <a href="../pre-commit/" target="_blank">pre-commit hooks</a> and remotely via <a href="../cicd/#github-actions" target="_blank">GitHub actions</a> in subsequent lessons.</li>
</ul>
<h2 id="implementation">Implementation</h2>
<p>In our <a href="https://github.com/GokuMohandas/Made-With-ML" target="_blank">codebase</a>, we'll be testing the <a href="#üíªnbsp-code">code</a>, <a href="#üî¢nbsp-data">data</a> and <a href="#ü§ñnbsp-models">models</a>.</p>
<div class="highlight"><pre><span></span><code>tests/
‚îú‚îÄ‚îÄ<span class="w"> </span>code/
‚îÇ<span class="w">   </span>‚îú‚îÄ‚îÄ<span class="w"> </span>conftest.py
‚îÇ<span class="w">   </span>‚îú‚îÄ‚îÄ<span class="w"> </span>test_data.py
‚îÇ<span class="w">   </span>‚îú‚îÄ‚îÄ<span class="w"> </span>test_predict.py
‚îÇ<span class="w">   </span>‚îú‚îÄ‚îÄ<span class="w"> </span>test_train.py
‚îÇ<span class="w">   </span>‚îú‚îÄ‚îÄ<span class="w"> </span>test_tune.py
‚îÇ<span class="w">   </span>‚îú‚îÄ‚îÄ<span class="w"> </span>test_utils.py
‚îÇ<span class="w">   </span>‚îî‚îÄ‚îÄ<span class="w"> </span>utils.py
‚îú‚îÄ‚îÄ<span class="w"> </span>data/
‚îÇ<span class="w">   </span>‚îú‚îÄ‚îÄ<span class="w"> </span>conftest.py
‚îÇ<span class="w">   </span>‚îî‚îÄ‚îÄ<span class="w"> </span>test_dataset.py
‚îî‚îÄ‚îÄ<span class="w"> </span>models/
‚îÇ<span class="w">   </span>‚îú‚îÄ‚îÄ<span class="w"> </span>conftest.py
‚îÇ<span class="w">   </span>‚îî‚îÄ‚îÄ<span class="w"> </span>test_behavioral.py
</code></pre></div>
<blockquote>
<p>Note that we aren't testing <code>evaluate.py</code> and <code>serve.py</code> because it involves complicated testing that's based on the data and models. We'll be testing these components as part of our integration tests when we test our system end-to-end.</p>
</blockquote>
<h2 id="code">üíª&nbsp; Code</h2>
<p>We'll start by testing our code and we'll use <a href="https://docs.pytest.org/en/stable/" target="_blank">pytest</a> as our testing framework for it's powerful builtin features such as <a href="#parametrize">parametrization</a>, <a href="#fixtures">fixtures</a>, <a href="#markers">markers</a> and more.</p>
<h3 id="configuration">Configuration</h3>
<p>Pytest expects tests to be organized under a <code>tests</code> directory by default. However, we can also add to our existing <code>pyproject.toml</code> file to configure any other test directories as well. Once in the directory, pytest looks for python scripts starting with <code>tests_*.py</code> but we can configure it to read any other file patterns as well.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Pytest</span>
<span class="k">[tool.pytest.ini_options]</span>
<span class="n">testpaths</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;tests&quot;</span><span class="p">]</span>
<span class="n">python_files</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;test_*.py&quot;</span>
</code></pre></div></td></tr></table></div>
<h3 id="assertions">Assertions</h3>
<p>Let's see what a sample test and it's results look like. Assume we have a simple function that decodes a list of indices into their respective classes using a dictionary mapping.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># madewithml/predict.py</span>
<span class="k">def</span><span class="w"> </span><span class="nf">decode</span><span class="p">(</span><span class="n">indices</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">index_to_class</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">index_to_class</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<p>To test this function, we can use <a href="https://docs.pytest.org/en/stable/assert.html" target="_blank">assert statements</a> to map inputs with expected outputs. The statement following the word <code>assert</code> must return <code>True</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># tests/code/test_predict.py</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_decode</span><span class="p">():</span>
<span class="n">decoded</span> <span class="o">=</span> <span class="n">predict</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span>
    <span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">index_to_class</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;y&quot;</span><span class="p">})</span>
<span class="k">assert</span> <span class="n">decoded</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<blockquote>
<p>We can also have assertions about <a href="https://docs.pytest.org/en/stable/assert.html#assertions-about-expected-exceptions" target="_blank">exceptions</a> like we do in lines 6-8 where all the operations under the with statement are expected to raise the specified exception.</p>
</blockquote>
<h3 id="execution">Execution</h3>
<p>We can execute our tests above using several different levels of granularity:</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>-m<span class="w"> </span>pytest<span class="w">                                          </span><span class="c1"># all tests</span>
python3<span class="w"> </span>-m<span class="w"> </span>pytest<span class="w"> </span>tests/code<span class="w">                               </span><span class="c1"># tests under a directory</span>
python3<span class="w"> </span>-m<span class="w"> </span>pytest<span class="w"> </span>tests/code/test_predict.py<span class="w">               </span><span class="c1"># tests for a single file</span>
python3<span class="w"> </span>-m<span class="w"> </span>pytest<span class="w"> </span>tests/code/test_predict.py::test_decode<span class="w">  </span><span class="c1"># tests for a single function</span>
</code></pre></div>
<p>Running our specific test above would produce the following output:
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>-m<span class="w"> </span>pytest<span class="w"> </span>tests/code/test_predict.py::test_decode<span class="w"> </span>--verbose<span class="w"> </span>--disable-warnings
</code></pre></div></p>
<pre class="output">
tests/code/test_predict.py::test_decode <span style="color: #5A9C4B; font-weight: 600;">PASSED           [100%]</span>
</pre>

<p>Had any of our assertions in this test failed, we would see the failed assertions, along with the expected and actual output from our function.</p>
<pre class="output">
tests/code/test_predict.py::test_decode <span style="color: #F50071; font-weight: 600">FAILED                          [100%]</span>

    def test_decode():
        decoded = predict.decode(
            indices=[0, 1, 1],
            index_to_class={0: "x", 1: "y"})
>       assert decoded == ["x", "x", "y"]
<span style="color: #F50071; font-weight: 600;">E       AssertionError: assert ['x', 'y', 'y'] == ['x', 'x', 'y']</span>
<span style="color: #F50071; font-weight: 600;">E        At index 1 diff: 'y' != 'x'</span>
</pre>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It's important to test for the variety of inputs and expected outputs that we outlined <a href="#how-should-we-test">above</a> and to <strong>never assume that a test is trivial</strong>. In our example above, it's important that we test for both "apple" and "Apple" in the event that our function didn't account for casing!</p>
</div>
<h3 id="classes">Classes</h3>
<p>We can also test classes and their respective functions.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">test_fit_transform</span><span class="p">():</span>
    <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">CustomPreprocessor</span><span class="p">()</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">dataset_loc</span><span class="o">=</span><span class="s2">&quot;...&quot;</span><span class="p">)</span>
    <span class="n">preprocessor</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">preprocessor</span><span class="o">.</span><span class="n">class_to_index</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span>
</code></pre></div></td></tr></table></div>
<blockquote>
<p>There are also more <a href="https://docs.pytest.org/en/stable/xunit_setup.html" target="_blank">xunit-style testing</a> options available as well for more involved testing with classes.</p>
</blockquote>
<h3 id="parametrize">Parametrize</h3>
<p>So far, in our tests, we've had to create individual assert statements to validate different combinations of inputs and expected outputs. However, there's a bit of redundancy here because the inputs always feed into our functions as arguments and the outputs are compared with our expected outputs. To remove this redundancy, pytest has the <a href="https://docs.pytest.org/en/stable/parametrize.html" target="_blank"><code>@pytest.mark.parametrize</code></a> decorator which allows us to represent our inputs and outputs as parameters.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span>
    <span class="s2">&quot;text, sw, clean_text&quot;</span><span class="p">,</span>
    <span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;hi&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="s2">&quot;hi&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;hi you&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;you&quot;</span><span class="p">],</span> <span class="s2">&quot;hi&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;hi yous&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;you&quot;</span><span class="p">],</span> <span class="s2">&quot;hi yous&quot;</span><span class="p">),</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_clean_text</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">sw</span><span class="p">,</span> <span class="n">clean_text</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">data</span><span class="o">.</span><span class="n">clean_text</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">stopwords</span><span class="o">=</span><span class="n">sw</span><span class="p">)</span> <span class="o">==</span> <span class="n">clean_text</span>
</code></pre></div></td></tr></table></div>
<ol>
<li><code class="highlight"><span class="p">[</span><span class="nx">Line</span><span class="w"> </span><span class="mf">2</span><span class="p">]</span></code>: define the names of the parameters under the decorator, ex. "fruit, crisp" (note that this is one string).</li>
<li><code class="highlight"><span class="p">[</span><span class="nx">Lines</span><span class="w"> </span><span class="mf">3</span><span class="o">-</span><span class="mf">7</span><span class="p">]</span></code>: provide a list of combinations of values for the parameters from Step 1.</li>
<li><code class="highlight"><span class="p">[</span><span class="nx">Line</span><span class="w"> </span><span class="mf">9</span><span class="p">]</span></code>: pass in parameter names to the test function.</li>
<li><code class="highlight"><span class="p">[</span><span class="nx">Line</span><span class="w"> </span><span class="mf">10</span><span class="p">]</span></code>: include necessary assert statements which will be executed for each of the combinations in the list from Step 2.</li>
</ol>
<p>Similarly, we could pass in an exception as the expected result as well:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span>
    <span class="s2">&quot;x, exception&quot;</span><span class="p">,</span>
    <span class="p">[</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">),</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_foo</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">exception</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="n">exception</span><span class="p">):</span>
        <span class="n">foo</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="fixtures">Fixtures</h3>
<p>Parametrization allows us to reduce redundancy inside test functions but what about reducing redundancy across different test functions? For example, suppose that different test functions all have a common component (ex. preprocessor). Here, we can use pytest's builtin <a href="https://docs.pytest.org/en/stable/fixture.html" target="_blank">fixture</a>, which is a function that is executed before the test function. Let's rewrite our <code>test_fit_transform</code> function from above using a fixture:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">test_fit_transform</span><span class="p">(</span><span class="n">dataset_loc</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">dataset_loc</span><span class="o">=</span><span class="n">dataset_loc</span><span class="p">)</span>
    <span class="n">preprocessor</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">preprocessor</span><span class="o">.</span><span class="n">class_to_index</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span>
</code></pre></div></td></tr></table></div>
<p>where <code>dataset_loc</code> and <code>preprocessor</code> are fixtures defined in our <code>tests/code/conftest.py</code> script:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># tests/code/conftest.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">madewithml.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">CustomPreprocessor</span>

<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">dataset_loc</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;https://raw.githubusercontent.com/GokuMohandas/Made-With-ML/main/datasets/dataset.csv&quot;</span>

<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">preprocessor</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">CustomPreprocessor</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<p>All of our test scripts know to look inside a <code>conftest.py</code> script in the same directory for any fixtures. Note that the name of the fixture and the input argument to our function have to be the same.</p>
<div class="admonition note">
<p class="admonition-title">Fixture scopes</p>
<p>Fixtures can have different scopes depending on how we want to use them. For example our <code>df</code> fixture has the module scope because we don't want to keep recreating it after every test but, instead, we want to create it just once for all the tests in our module (<code>tests/test_data.py</code>).</p>
<ul>
<li><code>function</code>: fixture is destroyed after every test. <code class="highlight"><span class="p">[</span><span class="k">default</span><span class="p">]</span></code></li>
<li><code>class</code>: fixture is destroyed after the last test in the class.</li>
<li><code>module</code>: fixture is destroyed after the last test in the module (script).</li>
<li><code>package</code>: fixture is destroyed after the last test in the package.</li>
<li><code>session</code>: fixture is destroyed after the last test of the session.</li>
</ul>
</div>
<h3 id="markers">Markers</h3>
<p>We've been able to execute our tests at various levels of granularity (all tests, script, function, etc.) but we can create custom granularity by using <a href="https://docs.pytest.org/en/stable/mark.html" target="_blank">markers</a>. We've already used one type of marker (parametrize) but there are several other <a href="https://docs.pytest.org/en/stable/mark.html#mark" target="_blank">builtin markers</a> as well. For example, the <a href="https://docs.pytest.org/en/stable/skipping.html#id1" target="_blank"><code>skipif</code></a> marker allows us to skip execution of a test if a condition is met. For example, supposed we only wanted to test training our model if a GPU is available:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">skipif</span><span class="p">(</span>
    <span class="ow">not</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">(),</span>
    <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Full training tests require a GPU.&quot;</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_training</span><span class="p">():</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
<p>We can also create our own custom markers with the exception of a few <a href="https://docs.pytest.org/en/stable/reference.html#marks" target="_blank">reserved</a> marker names.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">training</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_train_model</span><span class="p">(</span><span class="n">dataset_loc</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
<p>We can execute them by using the <code>-m</code> flag which requires a (case-sensitive) marker expression like below:</p>
<div class="highlight"><pre><span></span><code>pytest<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;training&quot;</span><span class="w">      </span><span class="c1">#  runs all tests marked with `training`</span>
pytest<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;not training&quot;</span><span class="w">  </span><span class="c1">#  runs all tests besides those marked with `training`</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The proper way to use markers is to explicitly list the ones we've created in our <a href="https://github.com/GokuMohandas/Made-With-ML/blob/main/pyproject.toml" target="_blank">pyproject.toml</a> file. Here we can specify that all markers must be defined in this file with the <code>--strict-markers</code> flag and then declare our markers (with some info about them) in our <code>markers</code> list:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">training</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_train_model</span><span class="p">():</span>
    <span class="k">assert</span> <span class="o">...</span>
</code></pre></div></td></tr></table></div>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Pytest</span>
<span class="k">[tool.pytest.ini_options]</span>
<span class="n">testpaths</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;tests&quot;</span><span class="p">]</span>
<span class="n">python_files</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;test_*.py&quot;</span>
<span class="n">addopts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;--strict-markers --disable-pytest-warnings&quot;</span>
<span class="hll"><span class="n">markers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
</span><span class="hll"><span class="w">    </span><span class="s2">&quot;training: tests that involve training&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="p">]</span>
</span></code></pre></div></td></tr></table></div>
Once we do this, we can view all of our existing list of markers by executing <code class="highlight">pytest<span class="w"> </span>--markers</code> and we'll receive an error when we're trying to use a new marker that's not defined here.</p>
</div>
<h3 id="coverage">Coverage</h3>
<p>As we're developing tests for our application's components, it's important to know how well we're covering our code base and to know if we've missed anything. We can use the <a href="https://coverage.readthedocs.io/" target="_blank">Coverage</a> library to track and visualize how much of our codebase our tests account for. With pytest, it's even easier to use this package thanks to the <a href="https://pytest-cov.readthedocs.io/" target="_blank">pytest-cov</a> plugin.</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>-m<span class="w"> </span>pytest<span class="w"> </span>tests/code<span class="w"> </span>--cov<span class="w"> </span>madewithml<span class="w"> </span>--cov-report<span class="w"> </span>html<span class="w"> </span>--disable-warnings
</code></pre></div>
<div class="ai-center-all">
    <img width="800" src="/static/images/mlops/testing/pytest.png" alt="pytest">
</div>

<p>Here we're asking to run all tests under <code>tests/code</code> and to check for coverage for all the code in our <code>madewithml</code> directory. When we run this, we'll see the tests from our tests directory executing while the coverage plugin is keeping tracking of which lines in our application are being executed. Once our tests are done, we can view the generated report either through the terminal:</p>
<div class="highlight"><pre><span></span><code>coverage<span class="w"> </span>report<span class="w"> </span>-m
</code></pre></div>
<pre class="output">
Name                    Stmts   Miss  Cover   Missing
-----------------------------------------------------
madewithml/config.py       16      0   100%
madewithml/data.py         51      0   100%
madewithml/models.py        2      0   100%
madewithml/predict.py      23      0   100%
madewithml/train.py        45      0   100%
madewithml/tune.py         51      0   100%
madewithml/utils.py        39      0   100%
-----------------------------------------------------
TOTAL                     227      0   100%
</pre>

<p>but a more interactive way is to view it through the <code>htmlcov/index.html</code> on a browser. Here we can click on individual files to see which parts were not covered by any tests.</p>
<div class="ai-center-all">
    <img width="800" src="/static/images/mlops/testing/coverage.png" alt="test coverage">
</div>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Though we have 100% coverage, this does not mean that our application is perfect. Coverage only indicates that a piece of code executed in a test, not necessarily that every part of it was tested, let alone thoroughly tested. Therefore, coverage should <strong>never</strong> be used as a representation of correctness. However, it is very useful to maintain coverage at 100% so we can know when new functionality has yet to be tested. In our CI/CD lesson, we'll see how to use GitHub actions to make 100% coverage a requirement when pushing to specific branches.</p>
</div>
<h3 id="exclusions">Exclusions</h3>
<p>Sometimes it doesn't make sense to write tests to cover every single line in our application yet we still want to account for these lines so we can maintain 100% coverage. We have two levels of purview when applying exclusions:</p>
<ol>
<li>
<p>Excusing lines by adding this comment <code># pragma: no cover, &lt;MESSAGE&gt;</code>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">if</span> <span class="n">results_fp</span><span class="p">:</span>  <span class="c1"># pragma: no cover, saving results</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">save_dict</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">results_fp</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>Excluding files by specifying them in our <code>pyproject.toml</code> configuration:</p>
</li>
</ol>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Pytest cov</span>
<span class="k">[tool.coverage.run]</span>
<span class="n">omit</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;madewithml/evaluate.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;madewithml/serve.py&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<blockquote>
<p>The main point is that we were able to add justification to these exclusions through comments so our team can follow our reasoning.</p>
</blockquote>
<p>Now that we have a foundation for testing traditional software, let's dive into testing our data and models in the context of machine learning systems.</p>
<h2 id="data">üî¢&nbsp; Data</h2>
<p>So far, we've used unit and integration tests to test the functions that interact with our data but we haven't tested the validity of the data itself. We're going to use the <a href="https://github.com/great-expectations/great_expectations" target="_blank">great expectations</a> library to test what our data is expected to look like. It's a library that allows us to create expectations as to what our data should look like in a standardized way. It also provides modules to seamlessly connect with backend data sources such as local file systems, S3, databases, etc. Let's explore the library by implementing the expectations we'll need for our application.</p>
<blockquote>
<p>üëâ &nbsp; Follow along interactive notebook in the <span class="twemoji github"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span> <a href="https://github.com/GokuMohandas/testing-ml" target="_blank"><strong>testing-ml</strong></a> repository as we implement the concepts below.</p>
</blockquote>
<p>First we'll load the data we'd like to apply our expectations on. We can load our data from a variety of <a href="https://docs.greatexpectations.io/docs/guides/connecting_to_your_data/connect_to_data_overview" target="_blank">sources</a> (filesystem, database, cloud etc.) which we can then wrap around a <a href="https://legacy.docs.greatexpectations.io/en/latest/autoapi/great_expectations/dataset/index.html" target="_blank">Dataset module</a> (Pandas / Spark DataFrame, SQLAlchemy). Since multiple data tests may want access to this data, we'll create a fixture for it.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># tests/data/conftest.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">great_expectations</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ge</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>

<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">&quot;module&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">df</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">dataset_loc</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getoption</span><span class="p">(</span><span class="s2">&quot;--dataset-loc&quot;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">ge</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">PandasDataset</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">dataset_loc</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
<h3 id="expectations">Expectations</h3>
<p>When it comes to creating expectations as to what our data should look like, we want to think about our entire dataset and all the features (columns) within it.</p>
<div class="highlight"><pre><span></span><code><span class="n">column_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;created_on&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;tag&quot;</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">expect_table_columns_to_match_ordered_list</span><span class="p">(</span><span class="n">column_list</span><span class="o">=</span><span class="n">column_list</span><span class="p">)</span>  <span class="c1"># schema adherence</span>
<span class="n">tags</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;computer-vision&quot;</span><span class="p">,</span> <span class="s2">&quot;natural-language-processing&quot;</span><span class="p">,</span> <span class="s2">&quot;mlops&quot;</span><span class="p">,</span> <span class="s2">&quot;other&quot;</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">expect_column_values_to_be_in_set</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;tag&quot;</span><span class="p">,</span> <span class="n">value_set</span><span class="o">=</span><span class="n">tags</span><span class="p">)</span>  <span class="c1"># expected labels</span>
<span class="n">df</span><span class="o">.</span><span class="n">expect_compound_columns_to_be_unique</span><span class="p">(</span><span class="n">column_list</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">])</span>  <span class="c1"># data leaks</span>
<span class="n">df</span><span class="o">.</span><span class="n">expect_column_values_to_not_be_null</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;tag&quot;</span><span class="p">)</span>  <span class="c1"># missing values</span>
<span class="n">df</span><span class="o">.</span><span class="n">expect_column_values_to_be_unique</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>  <span class="c1"># unique values</span>
<span class="n">df</span><span class="o">.</span><span class="n">expect_column_values_to_be_of_type</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">)</span>  <span class="c1"># type adherence</span>
</code></pre></div>
<p>Each of these expectations will create an output with details about success or failure, expected and observed values, expectations raised, etc. For example, the expectation <code class="highlight"><span class="n">df</span><span class="o">.</span><span class="n">expect_column_values_to_be_of_type</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">)</span></code> would produce the following if successful:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;exception_info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;raised_exception&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;exception_traceback&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;exception_message&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span>
<span class="w">  </span><span class="p">},</span>
<span class="hll"><span class="w">  </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span class="w">  </span><span class="nt">&quot;meta&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span>
<span class="w">  </span><span class="nt">&quot;expectation_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;kwargs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;column&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;title&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;type_&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;str&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;result_format&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;BASIC&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;meta&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span>
<span class="w">    </span><span class="nt">&quot;expectation_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;_expect_column_values_to_be_of_type__map&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;result&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;element_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">955</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;missing_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;missing_percent&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;unexpected_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;unexpected_percent&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;unexpected_percent_nonmissing&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;partial_unexpected_list&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>and if we have a failed expectation (ex. <code class="highlight"><span class="n">df</span><span class="o">.</span><span class="n">expect_column_values_to_be_of_type</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">)</span></code>), we'd receive this output(notice the counts and examples for what caused the failure):
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="hll"><span class="w">  </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span class="w">  </span><span class="nt">&quot;exception_info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;raised_exception&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;exception_traceback&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;exception_message&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;expectation_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;meta&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span>
<span class="w">    </span><span class="nt">&quot;kwargs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;column&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;title&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;type_&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;int&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;result_format&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;BASIC&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;expectation_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;_expect_column_values_to_be_of_type__map&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;result&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;element_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">955</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;missing_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;missing_percent&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;unexpected_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">955</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;unexpected_percent&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">100.0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;unexpected_percent_nonmissing&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">100.0</span><span class="p">,</span>
<span class="hll"><span class="w">    </span><span class="nt">&quot;partial_unexpected_list&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span class="w">      </span><span class="s2">&quot;How to Deal with Files in Google Colab: What You Need to Know&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;Machine Learning Methods Explained (+ Examples)&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;OpenMMLab Computer Vision&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">]</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;meta&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<p>There are just a few of the different expectations that we can create. Be sure to explore all the <a href="https://greatexpectations.io/expectations/">expectations</a>, including <a href="https://docs.greatexpectations.io/docs/guides/expectations/creating_custom_expectations/overview/">custom expectations</a>. Here are some other popular expectations that don't pertain to our specific dataset but are widely applicable:</p>
<ul>
<li>feature value relationships with other feature values ‚Üí <code>expect_column_pair_values_a_to_be_greater_than_b</code></li>
<li>value statistics (mean, std, median, max, min, sum, etc.) ‚Üí <code>expect_column_mean_to_be_between</code></li>
</ul>
<h3 id="suite">Suite</h3>
<p>Instead of running each of these individually, we can combine them all into an expectation suite.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># tests/data/test_dataset.py</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_dataset</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test dataset quality and integrity.&quot;&quot;&quot;</span>
    <span class="n">column_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;created_on&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;tag&quot;</span><span class="p">]</span>
    <span class="n">df</span><span class="o">.</span><span class="n">expect_table_columns_to_match_ordered_list</span><span class="p">(</span><span class="n">column_list</span><span class="o">=</span><span class="n">column_list</span><span class="p">)</span>  <span class="c1"># schema adherence</span>
    <span class="n">tags</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;computer-vision&quot;</span><span class="p">,</span> <span class="s2">&quot;natural-language-processing&quot;</span><span class="p">,</span> <span class="s2">&quot;mlops&quot;</span><span class="p">,</span> <span class="s2">&quot;other&quot;</span><span class="p">]</span>
    <span class="n">df</span><span class="o">.</span><span class="n">expect_column_values_to_be_in_set</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;tag&quot;</span><span class="p">,</span> <span class="n">value_set</span><span class="o">=</span><span class="n">tags</span><span class="p">)</span>  <span class="c1"># expected labels</span>
    <span class="n">df</span><span class="o">.</span><span class="n">expect_compound_columns_to_be_unique</span><span class="p">(</span><span class="n">column_list</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">])</span>  <span class="c1"># data leaks</span>
    <span class="n">df</span><span class="o">.</span><span class="n">expect_column_values_to_not_be_null</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;tag&quot;</span><span class="p">)</span>  <span class="c1"># missing values</span>
    <span class="n">df</span><span class="o">.</span><span class="n">expect_column_values_to_be_unique</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>  <span class="c1"># unique values</span>
    <span class="n">df</span><span class="o">.</span><span class="n">expect_column_values_to_be_of_type</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">)</span>  <span class="c1"># type adherence</span>

    <span class="c1"># Expectation suite</span>
<span class="hll">    <span class="n">expectation_suite</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">get_expectation_suite</span><span class="p">(</span><span class="n">discard_failed_expectations</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span class="hll">    <span class="n">results</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">expectation_suite</span><span class="o">=</span><span class="n">expectation_suite</span><span class="p">,</span> <span class="n">only_return_failures</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">to_json_dict</span><span class="p">()</span>
</span>    <span class="k">assert</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;success&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<p>We can now execute these data tests just like a code test.</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">DATASET_LOC</span><span class="o">=</span><span class="s2">&quot;https://raw.githubusercontent.com/GokuMohandas/Made-With-ML/main/datasets/dataset.csv&quot;</span>
pytest<span class="w"> </span>--dataset-loc<span class="o">=</span><span class="nv">$DATASET_LOC</span><span class="w"> </span>tests/data<span class="w"> </span>--verbose<span class="w"> </span>--disable-warnings
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We've added a <code>--dataset-loc</code> flag to pytest by specifying in our <code>tests/data/conftest.py</code> script. This allows us to pass in the dataset location as an argument to our tests.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># tests/data/conftest.py</span>
<span class="k">def</span><span class="w"> </span><span class="nf">pytest_addoption</span><span class="p">(</span><span class="n">parser</span><span class="p">):</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">addoption</span><span class="p">(</span><span class="s2">&quot;--dataset-loc&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Dataset location.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</div>
<blockquote>
<p>We're keeping things simple by using our expectations with pytest but Great expectations also has a lot more functionality around <a href="https://docs.greatexpectations.io/docs/guides/connecting_to_your_data/connect_to_data_lp" target="_blank">connecting</a> to data sources, <a href="https://docs.greatexpectations.io/docs/terms/checkpoint/" target="_blank">Checkpoints</a> to execute suites across various parts of the pipeline, <a href="https://docs.greatexpectations.io/docs/terms/data_docs/" target="_blank">data docs</a> to generate reports, etc.</p>
</blockquote>
<h3 id="production">Production</h3>
<p>While we're validating our datasets inside our machine learning applications, in most production scenarios, the data validation happens much further upstream. Our dataset may not be used just for our specific application and may actually be feeding into many other downstream application (ML and otherwise). Therefore, it's a great idea to execute these data validation tests as up stream as possible so that downstream applications can reliably use the data.</p>
<div class="ai-center-all mb-4">
    <img width="650" src="/static/images/mlops/testing/production.png" alt="ELT pipelines in production">
</div>

<blockquote>
<p>Learn more about different data systems in our <a href="../data-engineering/" target="_blank">data engineering lesson</a> if you're not familiar with them.</p>
</blockquote>
<h2 id="models">ü§ñ&nbsp; Models</h2>
<p>The final aspect of testing ML systems involves how to test machine learning models during training, evaluation, inference and deployment.</p>
<h3 id="training">Training</h3>
<p>We want to write tests iteratively while we're developing our training pipelines so we can catch errors quickly. This is especially important because, unlike traditional software, ML systems can run to completion without throwing any exceptions / errors but can produce incorrect systems. We also want to catch errors quickly to save on time and compute.</p>
<ul>
<li>Check shapes and values of model output
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">assert</span> <span class="n">model</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">inputs</span><span class="p">),</span> <span class="n">num_classes</span><span class="p">])</span>
</code></pre></div></td></tr></table></div></li>
<li>Check for decreasing loss after one batch of training
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">assert</span> <span class="n">epoch_loss</span> <span class="o">&lt;</span> <span class="n">prev_epoch_loss</span>
</code></pre></div></td></tr></table></div></li>
<li>Overfit on a batch
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">accuracy</span> <span class="o">=</span> <span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">batches</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">assert</span> <span class="n">accuracy</span> <span class="o">==</span> <span class="n">pytest</span><span class="o">.</span><span class="n">approx</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span> <span class="c1"># 0.95 ¬± 0.05</span>
</code></pre></div></td></tr></table></div></li>
<li>Train to completion (tests early stopping, saving, etc.)
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">learning_rate</span> <span class="o">&gt;=</span> <span class="n">min_learning_rate</span>
<span class="k">assert</span> <span class="n">artifacts</span>
</code></pre></div></td></tr></table></div></li>
<li>On different devices
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">assert</span> <span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda&quot;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can mark the compute intensive tests with a pytest marker and only execute them when there is a change being made to system affecting the model.
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">training</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_train_model</span><span class="p">():</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div></p>
</div>
<h3 id="behavioral-testing">Behavioral testing</h3>
<p>Behavioral testing is the process of testing input data and expected outputs while treating the model as a black box (model agnostic evaluation). They don't necessarily have to be adversarial in nature but more along the types of perturbations we may expect to see in the real world once our model is deployed. A landmark paper on this topic is <a href="https://arxiv.org/abs/2005.04118" target="_blank">Beyond Accuracy: Behavioral Testing of NLP Models with CheckList</a> which breaks down behavioral testing into three types of tests:</p>
<ul>
<li><code class="highlight"><span class="nx">invariance</span></code>: Changes should not affect outputs.
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># INVariance via verb injection (changes should not affect outputs)</span>
<span class="n">get_label</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Transformers applied to NLP have revolutionized machine learning.&quot;</span><span class="p">,</span> <span class="n">predictor</span><span class="o">=</span><span class="n">predictor</span><span class="p">)</span>
<span class="n">get_label</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Transformers applied to NLP have disrupted machine learning.&quot;</span><span class="p">,</span> <span class="n">predictor</span><span class="o">=</span><span class="n">predictor</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></li>
</ul>
<pre class="output">
'natural-language-processing'
'natural-language-processing'
</pre>
<ul>
<li><code class="highlight"><span class="nx">directional</span></code>: Change should affect outputs.
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># DIRectional expectations (changes with known outputs)</span>
<span class="n">get_label</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;ML applied to text classification.&quot;</span><span class="p">,</span> <span class="n">predictor</span><span class="o">=</span><span class="n">predictor</span><span class="p">)</span>
<span class="n">get_label</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;ML applied to image classification.&quot;</span><span class="p">,</span> <span class="n">predictor</span><span class="o">=</span><span class="n">predictor</span><span class="p">)</span>
<span class="n">get_label</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;CNNs for text classification.&quot;</span><span class="p">,</span> <span class="n">predictor</span><span class="o">=</span><span class="n">predictor</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></li>
</ul>
<pre class="output">
'natural-language-processing'
'computer-vision'
'natural-language-processing'
</pre>
<ul>
<li><code class="highlight"><span class="nx">minimum</span><span class="w"> </span><span class="nx">functionality</span></code>: Simple combination of inputs and expected outputs.
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Minimum Functionality Tests (simple input/output pairs)</span>
<span class="n">get_label</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Natural language processing is the next big wave in machine learning.&quot;</span><span class="p">,</span> <span class="n">predictor</span><span class="o">=</span><span class="n">predictor</span><span class="p">)</span>
<span class="n">get_label</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;MLOps is the next big wave in machine learning.&quot;</span><span class="p">,</span> <span class="n">predictor</span><span class="o">=</span><span class="n">predictor</span><span class="p">)</span>
<span class="n">get_label</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;This is about graph neural networks.&quot;</span><span class="p">,</span> <span class="n">predictor</span><span class="o">=</span><span class="n">predictor</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></li>
</ul>
<pre class="output">
'natural-language-processing'
'mlops'
'other'
</pre>

<p>And we can convert these tests into proper parameterized tests by first defining from fixtures in our <code>tests/model/conftest.py</code> and our <code>tests/model/utils.py</code> scripts:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># tests/model/conftest.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ray.train.torch.torch_predictor</span><span class="w"> </span><span class="kn">import</span> <span class="n">TorchPredictor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">madewithml</span><span class="w"> </span><span class="kn">import</span> <span class="n">predict</span>

<span class="k">def</span><span class="w"> </span><span class="nf">pytest_addoption</span><span class="p">(</span><span class="n">parser</span><span class="p">):</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">addoption</span><span class="p">(</span><span class="s2">&quot;--run-id&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Run ID of model to use.&quot;</span><span class="p">)</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">&quot;module&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">run_id</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">request</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getoption</span><span class="p">(</span><span class="s2">&quot;--run-id&quot;</span><span class="p">)</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">&quot;module&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">predictor</span><span class="p">(</span><span class="n">run_id</span><span class="p">):</span>
    <span class="n">best_checkpoint</span> <span class="o">=</span> <span class="n">predict</span><span class="o">.</span><span class="n">get_best_checkpoint</span><span class="p">(</span><span class="n">run_id</span><span class="o">=</span><span class="n">run_id</span><span class="p">)</span>
    <span class="n">predictor</span> <span class="o">=</span> <span class="n">TorchPredictor</span><span class="o">.</span><span class="n">from_checkpoint</span><span class="p">(</span><span class="n">best_checkpoint</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">predictor</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># tests/model/utils.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">madewithml</span><span class="w"> </span><span class="kn">import</span> <span class="n">predict</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_label</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">predictor</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">text</span><span class="p">],</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;other&quot;</span><span class="p">})</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)[</span><span class="s2">&quot;predictions&quot;</span><span class="p">]</span>
    <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">get_preprocessor</span><span class="p">()</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">predict</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">preprocessor</span><span class="o">.</span><span class="n">index_to_class</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">label</span>
</code></pre></div></td></tr></table></div>
<p>And now, we can use these components to create our behavioral tests:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># tests/model/test_behavioral.py</span>
<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span>
    <span class="s2">&quot;input_a, input_b, label&quot;</span><span class="p">,</span>
    <span class="p">[</span>
        <span class="p">(</span>
            <span class="s2">&quot;Transformers applied to NLP have revolutionized machine learning.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Transformers applied to NLP have disrupted machine learning.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;natural-language-processing&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_invariance</span><span class="p">(</span><span class="n">input_a</span><span class="p">,</span> <span class="n">input_b</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">predictor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;INVariance via verb injection (changes should not affect outputs).&quot;&quot;&quot;</span>
    <span class="n">label_a</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_label</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">input_a</span><span class="p">,</span> <span class="n">predictor</span><span class="o">=</span><span class="n">predictor</span><span class="p">)</span>
    <span class="n">label_b</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_label</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">input_b</span><span class="p">,</span> <span class="n">predictor</span><span class="o">=</span><span class="n">predictor</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">label_a</span> <span class="o">==</span> <span class="n">label_b</span> <span class="o">==</span> <span class="n">label</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># tests/model/test_behavioral.py</span>
<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span>
    <span class="s2">&quot;input, label&quot;</span><span class="p">,</span>
    <span class="p">[</span>
        <span class="p">(</span>
            <span class="s2">&quot;ML applied to text classification.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;natural-language-processing&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="p">(</span>
            <span class="s2">&quot;ML applied to image classification.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;computer-vision&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="p">(</span>
            <span class="s2">&quot;CNNs for text classification.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;natural-language-processing&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_directional</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">predictor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;DIRectional expectations (changes with known outputs).&quot;&quot;&quot;</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_label</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">predictor</span><span class="o">=</span><span class="n">predictor</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">label</span> <span class="o">==</span> <span class="n">prediction</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># tests/model/test_behavioral.py</span>
<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span>
    <span class="s2">&quot;input, label&quot;</span><span class="p">,</span>
    <span class="p">[</span>
        <span class="p">(</span>
            <span class="s2">&quot;Natural language processing is the next big wave in machine learning.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;natural-language-processing&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="p">(</span>
            <span class="s2">&quot;MLOps is the next big wave in machine learning.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mlops&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="p">(</span>
            <span class="s2">&quot;This is about graph neural networks.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;other&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_mft</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">predictor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Minimum Functionality Tests (simple input/output pairs).&quot;&quot;&quot;</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_label</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">predictor</span><span class="o">=</span><span class="n">predictor</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">label</span> <span class="o">==</span> <span class="n">prediction</span>
</code></pre></div></td></tr></table></div>
<p>And we can execute them just like any other test:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Model tests</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">EXPERIMENT_NAME</span><span class="o">=</span><span class="s2">&quot;llm&quot;</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">RUN_ID</span><span class="o">=</span><span class="k">$(</span>python<span class="w"> </span>madewithml/predict.py<span class="w"> </span>get-best-run-id<span class="w"> </span>--experiment-name<span class="w"> </span><span class="nv">$EXPERIMENT_NAME</span><span class="w"> </span>--metric<span class="w"> </span>val_loss<span class="w"> </span>--mode<span class="w"> </span>ASC<span class="k">)</span>
pytest<span class="w"> </span>--run-id<span class="o">=</span><span class="nv">$RUN_ID</span><span class="w"> </span>tests/model<span class="w"> </span>--verbose<span class="w"> </span>--disable-warnings
</code></pre></div>
<h2 id="testing-vs-monitoring">Testing vs. monitoring</h2>
<p>We'll conclude by talking about the similarities and distinctions between testing and <a href="../monitoring/" target="_blank">monitoring</a>. They're both integral parts of the ML development pipeline and depend on each other for iteration. Testing is assuring that our system (code, data and models) passes the expectations that we've established offline. Whereas, monitoring involves that these expectations continue to pass online on live production data while also ensuring that their data distributions are <a href="../monitoring/#measuring-drift" target="_blank">comparable</a> to the reference window (typically subset of training data) through <span class="arithmatex">\(t_n\)</span>. When these conditions no longer hold true, we need to inspect more closely (retraining may not always fix our root problem).</p>
<p>With <a href="../monitoring/" target="_blank">monitoring</a>, there are quite a few distinct concerns that we didn't have to consider during testing since it involves (live) data we have yet to see.</p>
<ul>
<li>features and prediction distributions (drift), typing, schema mismatches, etc.</li>
<li>determining model performance (rolling and window metrics on overall and slices of data) using indirect signals (since labels may not be readily available).</li>
<li>in situations with large data, we need to know which data points to label and upsample for training.</li>
<li>identifying anomalies and outliers.</li>
</ul>
<blockquote>
<p>We'll cover all of these concepts in much more depth (and code) in our <a href="../monitoring/" target="_blank">monitoring</a> lesson.</p>
</blockquote>
<h2 id="resources">Resources</h2>
<ul>
<li><a href="https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/aad9f93b86b7addfea4c419b9100c6cdd26cacea.pdf" target="_blank">The ML Test Score: A Rubric for ML Production Readiness and Technical Debt Reduction</a></li>
<li><a href="https://arxiv.org/abs/2005.04118" target="_blank">Beyond Accuracy: Behavioral Testing of NLP Models with CheckList</a></li>
<li><a href="https://arxiv.org/abs/2101.04840" target="_blank">Robustness Gym: Unifying the NLP Evaluation Landscape</a></li>
</ul>
<!-- Course signup -->
<hr style="margin-top: 2.25rem; margin-bottom: 2.25rem;">

<div class="admonition question mx-md-5">
<p class="admonition-title">Upcoming live cohorts</p>
<p>Sign up for our upcoming live cohort, where we'll provide <b>live lessons + QA</b>, <b>compute (GPUs)</b> and <b>community</b> to learn everything in one day.
<script src="//embed.typeform.com/next/embed.js"></script>
</p><div class="ai-center-all mb-3">
    <button data-tf-popup="hFw8rLTJ" data-tf-opacity="100" data-tf-size="100" data-tf-iframe-props="title=Made With ML" data-tf-transitive-search-params data-tf-medium="snippet" data-tf-hidden="utm_source="class="md-button md-button--green-gradient mb-2 mb-md-0 mt-md-0 mt-1" style="cursor: pointer !important;"><span class="twemoji mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M20.322.75a10.75 10.75 0 00-7.373 2.926l-1.304 1.23A23.743 23.743 0 0010.103 6.5H5.066a1.75 1.75 0 00-1.5.85l-2.71 4.514a.75.75 0 00.49 1.12l4.571.963c.039.049.082.096.129.14L8.04 15.96l1.872 1.994c.044.047.091.09.14.129l.963 4.572a.75.75 0 001.12.488l4.514-2.709a1.75 1.75 0 00.85-1.5v-5.038a23.741 23.741 0 001.596-1.542l1.228-1.304a10.75 10.75 0 002.925-7.374V2.499A1.75 1.75 0 0021.498.75h-1.177zM16 15.112c-.333.248-.672.487-1.018.718l-3.393 2.262.678 3.223 3.612-2.167a.25.25 0 00.121-.214v-3.822zm-10.092-2.7L8.17 9.017c.23-.346.47-.685.717-1.017H5.066a.25.25 0 00-.214.121l-2.167 3.612 3.223.679zm8.07-7.644a9.25 9.25 0 016.344-2.518h1.177a.25.25 0 01.25.25v1.176a9.25 9.25 0 01-2.517 6.346l-1.228 1.303a22.248 22.248 0 01-3.854 3.257l-3.288 2.192-1.743-1.858a.764.764 0 00-.034-.034l-1.859-1.744 2.193-3.29a22.248 22.248 0 013.255-3.851l1.304-1.23zM17.5 8a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zm-11 13c.9-.9.9-2.6 0-3.5-.9-.9-2.6-.9-3.5 0-1.209 1.209-1.445 3.901-1.49 4.743a.232.232 0 00.247.247c.842-.045 3.534-.281 4.743-1.49z"></path></svg></span> Learn more</a>
</div><p></p>
</div>

<!-- Citation -->
<hr style="margin-top: 2.25rem; margin-bottom: 2.25rem;">

<p>To cite this content, please use:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nc">@article</span><span class="p">{</span><span class="nl">madewithml</span><span class="p">,</span>
<span class="w">    </span><span class="na">author</span><span class="w">       </span><span class="p">=</span><span class="w"> </span><span class="s">{Goku Mohandas}</span><span class="p">,</span>
<span class="w">    </span><span class="na">title</span><span class="w">        </span><span class="p">=</span><span class="w"> </span><span class="s">{ Code - Made With ML }</span><span class="p">,</span>
<span class="w">    </span><span class="na">howpublished</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">{\url{https://madewithml.com/}}</span><span class="p">,</span>
<span class="w">    </span><span class="na">year</span><span class="w">         </span><span class="p">=</span><span class="w"> </span><span class="s">{2023}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
  
    
  
  <br>

              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      <div style="display:flex; flex-direction:column;"><a href="https://www.anyscale.com?utm_source=madewithmml&utm_medium=website&utm_campaign=footer" target="_blank"><img src="/static/images/anyscale-white-text.svg" style="width: 4rem;"></a> ¬© 2025 Anyscale, Inc. <br> <a href="https://www.anyscale.com/privacy-policy" target="_blank">Anyscale Privacy Policy</a></div>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/GokuMohandas" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://linkedin.com/in/goku" target="_blank" rel="noopener" title="linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/GokuMohandas" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/madewithml?sub_confirmation=1" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:goku@madewithml.com" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480v-83.6c0-4 1.5-7.8 4.2-10.7l167.6-182.9c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8l-88.3-44.2C7.1 311.3.3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "content.tabs.link"], "search": "../../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
     

      <script src="../../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
        
          <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
        
      
        
          <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
        
      
        
          <script src="https://cdnjs.cloudflare.com/ajax/libs/tablesort/5.2.1/tablesort.min.js"></script>
        
      
        
          <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        
      
        
          <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
      
        
          <script src="../../../static/js/custom.js"></script>
        
      
        
          <script src="../../../static/js/termynal.js"></script>
        
      
    

<!-- Google Tag Manager (noscript) -->
<noscript>
  <iframe
    src="https://www.googletagmanager.com/ns.html?id=GTM-P8H6KQG"
    height="0"
    width="0"
    style="display: none; visibility: hidden"
  ></iframe>
</noscript>
<!-- End Google Tag Manager (noscript) -->


  </body>
</html>