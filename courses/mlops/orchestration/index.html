
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Create, schedule and monitor workflows by creating scalable pipelines.">
      
      
        <meta name="author" content="Goku Mohandas">
      
      
        <link rel="canonical" href="https://madewithml.com/courses/mlops/orchestration/">
      
      
      
      <link rel="icon" href="../../../favicon.ico">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.18">
    
    
      
        <title>Orchestration for Machine Learning - Made With ML by Anyscale</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Epilogue:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Epilogue";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../static/scss/extra.css">
    
      <link rel="stylesheet" href="../../../static/scss/bs.css">
    
      <link rel="stylesheet" href="../../../static/scss/termynal.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    

  <!-- Set title -->
  
  
    
  

  <!-- Set description -->
  
  
    
  

  <!-- Set image -->
  
  
    
  

  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Orchestration for Machine Learning - Made With ML by Anyscale" />
  <meta property="og:description" content="Create, schedule and monitor workflows by creating scalable pipelines." />
  <meta property="og:url" content="https://madewithml.com/courses/mlops/orchestration/" />
  <meta property="og:image" content="https://madewithml.com/static/images/mlops.png" />
  <meta property="og:image:type" content="image/png" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@GokuMohandas" />
  <meta name="twitter:creator" content="@GokuMohandas" />
  <meta name="twitter:title" content="Orchestration for Machine Learning - Made With ML by Anyscale" />
  <meta name="twitter:description" content="Create, schedule and monitor workflows by creating scalable pipelines." />
  <meta name="twitter:image" content="https://madewithml.com/static/images/mlops.png" />

  <!-- GTM Container -->
  <script>
    (function (w, d, s, l, i) {
      w[l] = w[l] || [];
      w[l].push({
        "gtm.start": new Date().getTime(),
        event: "gtm.js",
      });
      var f = d.getElementsByTagName(s)[0],
        j = d.createElement(s),
        dl = l != "dataLayer" ? "&l=" + l : "";
      j.async = true;
      j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
      f.parentNode.insertBefore(j, f);
    })(window, document, "script", "dataLayer", "GTM-P8H6KQG");
  </script>

  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#intuition" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            
<div class="ai-announce">
  Try Ray with $100 credit — <a href="https://console.anyscale.com/register/ha?utm_source=made_with_ml&utm_medium=website&utm_campaign=banner" target="_blank" class="ai-announce-link">Start Now</a>
</div>

          </div>
          
        </aside>
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Made With ML by Anyscale" class="md-header__button md-logo" aria-label="Made With ML by Anyscale" data-md-component="logo">
      
  <img src="../../../static/images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Made With ML by Anyscale
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Orchestration for Machine Learning
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/GokuMohandas/Made-With-ML" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GokuMohandas/MadeWithML
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../about/" class="md-tabs__link">
      About
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="/#course" class="md-tabs__link">
        Course
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="/courses/foundations/" class="md-tabs__link">
        Foundations
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../misc/newsletter/" class="md-tabs__link">
      Subscribe
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="https://discord.com/channels/1078171187609337896/1078171189169635472" class="md-tabs__link">
      Community
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Made With ML by Anyscale" class="md-nav__button md-logo" aria-label="Made With ML by Anyscale" data-md-component="logo">
      
  <img src="../../../static/images/logo.png" alt="logo">

    </a>
    Made With ML by Anyscale
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/GokuMohandas/Made-With-ML" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GokuMohandas/MadeWithML
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../about/" class="md-nav__link">
        About
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Course
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Course
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/#course" class="md-nav__link">
        Lessons
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
      
      
      
        <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
          🎨 &nbsp; Design
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          🎨 &nbsp; Design
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setup/" class="md-nav__link">
        Setup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../product-design/" class="md-nav__link">
        Product
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../systems-design/" class="md-nav__link">
        Systems
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
          🔢 &nbsp; Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          🔢 &nbsp; Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../preparation/" class="md-nav__link">
        Preparation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../exploratory-data-analysis/" class="md-nav__link">
        Exploration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../preprocessing/" class="md-nav__link">
        Preprocessing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../distributed-data/" class="md-nav__link">
        Distributed
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
      
      
      
        <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
          📈 &nbsp; Model
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          📈 &nbsp; Model
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../training/" class="md-nav__link">
        Training
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../experiment-tracking/" class="md-nav__link">
        Tracking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tuning/" class="md-nav__link">
        Tuning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../evaluation/" class="md-nav__link">
        Evaluation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../serving/" class="md-nav__link">
        Serving
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
      
      
      
        <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
          💻 &nbsp; Developing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_5">
          <span class="md-nav__icon md-icon"></span>
          💻 &nbsp; Developing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../scripting/" class="md-nav__link">
        Scripting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        CLI
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
      
      
      
        <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
          📦 &nbsp; Utilities
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_6">
          <span class="md-nav__icon md-icon"></span>
          📦 &nbsp; Utilities
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../logging/" class="md-nav__link">
        Logging
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../documentation/" class="md-nav__link">
        Documentation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../styling/" class="md-nav__link">
        Styling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pre-commit/" class="md-nav__link">
        Pre-commit
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
      
      
      
        <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
          ✅ &nbsp; Testing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_7">
          <span class="md-nav__icon md-icon"></span>
          ✅ &nbsp; Testing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../testing/" class="md-nav__link">
        Code
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../testing/#data" class="md-nav__link">
        Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../testing/#models" class="md-nav__link">
        Models
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8" >
      
      
      
        <label class="md-nav__link" for="__nav_3_8" id="__nav_3_8_label" tabindex="0">
          ♻️ &nbsp; Reproducibility
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_8">
          <span class="md-nav__icon md-icon"></span>
          ♻️ &nbsp; Reproducibility
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../versioning/" class="md-nav__link">
        Versioning
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_9" >
      
      
      
        <label class="md-nav__link" for="__nav_3_9" id="__nav_3_9_label" tabindex="0">
          🚀 &nbsp; Production
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_9">
          <span class="md-nav__icon md-icon"></span>
          🚀 &nbsp; Production
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jobs-and-services/" class="md-nav__link">
        Jobs & Services
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cicd/" class="md-nav__link">
        CI/CD workflows
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../monitoring/" class="md-nav__link">
        Monitoring
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data-engineering/" class="md-nav__link">
        Data engineering
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Foundations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Foundations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/courses/foundations/" class="md-nav__link">
        Lessons
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
      
      
      
        <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
          🛠 &nbsp; Toolkit
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          🛠 &nbsp; Toolkit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/notebooks/" class="md-nav__link">
        Notebooks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/python/" class="md-nav__link">
        Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/numpy/" class="md-nav__link">
        NumPy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/pandas/" class="md-nav__link">
        Pandas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/pytorch/" class="md-nav__link">
        PyTorch
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
      
      
      
        <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
          🔥 &nbsp; Machine Learning
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          🔥 &nbsp; Machine Learning
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/linear-regression/" class="md-nav__link">
        Linear regression
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/logistic-regression/" class="md-nav__link">
        Logistic regression
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/neural-networks/" class="md-nav__link">
        Neural networks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/data-quality/" class="md-nav__link">
        Data quality
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/utilities/" class="md-nav__link">
        Utilities
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
          🤖 &nbsp; Deep Learning
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          🤖 &nbsp; Deep Learning
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/convolutional-neural-networks/" class="md-nav__link">
        CNNs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/embeddings/" class="md-nav__link">
        Embeddings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/recurrent-neural-networks/" class="md-nav__link">
        RNNs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/attention/" class="md-nav__link">
        Attention
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/transformers/" class="md-nav__link">
        Transformers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../misc/newsletter/" class="md-nav__link">
        Subscribe
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://discord.com/channels/1078171187609337896/1078171189169635472" class="md-nav__link">
        Community
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#intuition" class="md-nav__link">
    Intuition
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#airflow" class="md-nav__link">
    Airflow
  </a>
  
    <nav class="md-nav" aria-label="Airflow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#set-up" class="md-nav__link">
    Set up
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#webserver" class="md-nav__link">
    Webserver
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scheduler" class="md-nav__link">
    Scheduler
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executor" class="md-nav__link">
    Executor
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dags" class="md-nav__link">
    DAGs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tasks" class="md-nav__link">
    Tasks
  </a>
  
    <nav class="md-nav" aria-label="Tasks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#operators" class="md-nav__link">
    Operators
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relationships" class="md-nav__link">
    Relationships
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xcoms" class="md-nav__link">
    XComs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dag-runs" class="md-nav__link">
    DAG runs
  </a>
  
    <nav class="md-nav" aria-label="DAG runs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#manual" class="md-nav__link">
    Manual
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interval" class="md-nav__link">
    Interval
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sensors" class="md-nav__link">
    Sensors
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dataops" class="md-nav__link">
    DataOps
  </a>
  
    <nav class="md-nav" aria-label="DataOps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#extract-and-load" class="md-nav__link">
    Extract and load
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate" class="md-nav__link">
    Validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transform" class="md-nav__link">
    Transform
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlops" class="md-nav__link">
    MLOps
  </a>
  
    <nav class="md-nav" aria-label="MLOps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dataset" class="md-nav__link">
    Dataset
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_2" class="md-nav__link">
    Validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#train" class="md-nav__link">
    Train
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#continual-learning" class="md-nav__link">
    Continual learning
  </a>
  
    <nav class="md-nav" aria-label="Continual learning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#monitoring" class="md-nav__link">
    Monitoring
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retraining" class="md-nav__link">
    Retraining
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
  
  
    <div class="row">
      <div class="col-md-8">
        <h1 style="margin-bottom: 0.5rem;">Orchestration for Machine Learning</h1>
      </div>
      <div class="col-md-4 ai-center-all order-first order-md-last mb-2 mb-md-0 mb-lg-0">
        <a href="/courses/mlops" class="mb-2">
          <span class="twemoji">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M7.78 12.53a.75.75 0 0 1-1.06 0L2.47 8.28a.75.75 0 0 1 0-1.06l4.25-4.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042L4.81 7h7.44a.75.75 0 0 1 0 1.5H4.81l2.97 2.97a.75.75 0 0 1 0 1.06Z"/></svg>
          </span> View all lessons</a>
      </div>
    </div>
    <hr class="mt-0 mt-md-2 mt-lg-2">
    <div class="row">
      <div class="col-md-8">
        
          <span>Create, schedule and monitor workflows by creating scalable pipelines.</span>
        
      </div>
      <div class="col-md-4 order-first order-md-last">
        <div class="row mb-4 mb-md-0 mb-lg-0">
          <div class="col-md-3 col-2 ai-center-all" style="padding-right: 10px;">
            <img src="/static/images/goku_circle.png" style="width: 3rem; max-width: 120%;" alt="Goku Mohandas">
          </div>
          <div class="col-md-9 col-10" style="padding-left: 5px;">
            <div>Goku Mohandas</div>
            <div>
              <a href="https://twitter.com/GokuMohandas" target="_blank">
                <span class="twemoji twitter">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
                </span></a> &middot;
              <a href="https://linkedin.com/in/goku" target="_blank">
                <span class="twemoji linkedin">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
                </span></a> &middot;
              <a href="https://github.com/gokumohandas" target="_blank">
                <span class="twemoji github">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
                </span></a> &middot;
              <a href="https://www.youtube.com/c/MadeWithML" target="_blank">
                <span class="twemoji youtube">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
                </span></a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Links -->
    <div class="mt-1"></div>
    
      <span class="twemoji">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"/></svg>
      </span>
      <a href="https://github.com/GokuMohandas/data-engineering" target="_blank">Repository</a>
    
    
    
    

    <!-- Subscribe -->
    <!-- DON'T FORGET TO CHANGE LINK INSIDE index.html -->
<div class="modal fade" id="newsletterForm" tabindex="-1" role="dialog" aria-labelledby="newsletterFormLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header" style="padding: 0.5rem 1rem 0.5rem 1rem;">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <iframe width="540" height="600"
        src="https://c8efd03b.sibforms.com/serve/MUIFAKa3IQxVRvYHZ_oiARAblHq4WbNhDT72vx1pHJFklbHrp4V813O6mQMUHN5ikC51vZBBw2VqyEgMGgf6NFQg9rC8qgcURZBtzPj5TjOFimUAPyYPTLFrmd6nRKV0OK09SRnZxucZX0xMGR02ADg0GSvd_see2qS0VZnFPJ_JudrivA7uA4fs4BZrNn_3_fMjmF_Bj9ZOD9Ia"
        frameborder="0" scrolling="auto" allowfullscreen
        style="display: block;margin-left: auto;margin-right: auto;max-width: 100%;"></iframe>
    </div>
  </div>
</div>

<div class="admonition abstract" style="margin-top: 2rem;">
  <p class="admonition-title">Subscribe to our newsletter</p>
  <p>📬&nbsp; Receive new lessons straight to your inbox (once a month) and join <b>40K+</b>
    developers in learning how to responsibly deliver value with ML.</p>
  <div class="row">
    <div class="col-md-9">
      <input class="revue-form-field" placeholder="Work email" type="email" name="member[email]"
        id="member_email" style="width: 100%; height: 95%; border: 1px solid #b3b3b3; border-radius: 3px; font-size: 0.8rem;">
    </div>
    <div class="col-md-3 pl-md-0">
      <button class="md-button md-button--purple-gradient mt-md-0 mt-2" type="submit"
        style="cursor: pointer !important; height: 95%;" data-toggle="modal" data-target="#newsletterForm">Subscribe</button>
    </div>
  </div>
</div>
<hr style="margin-top: 2rem; margin-bottom: 2rem;">

  
  <style>
  .md-content {
    padding-left: 2.5rem;
    padding-right: 2.5rem;
  }

  /* Mobile */
  @media (max-width: 480px) {
    .md-content {
      padding-left: 0rem;
      padding-right: 0rem;
    }
  }

  /* Desktop */
  @media (min-width: 768px) {

    /* .md-nav--primary {
      display: none !important;
    } */
    .md-sidebar--primary {
      width: 9rem !important;
    }

    .md-sidebar--secondary {
      width: 9rem !important;
    }
  }
</style>

<h2 id="intuition">Intuition</h2>
<p>So far we've implemented our DataOps (ELT, validation, etc.) and MLOps (optimization, training, evaluation, etc.) workflows as Python function calls. This has worked well since our dataset is static and small. But happens when we need to:</p>
<ul>
<li><strong>schedule</strong> these workflows as new data arrives?</li>
<li><strong>scale</strong> these workflows as our data grows?</li>
<li><strong>share</strong> these workflows to downstream applications?</li>
<li><strong>monitor</strong> these workflows?</li>
</ul>
<p>We'll need to break down our end-to-end ML pipeline into individual workflows that can be orchestrated as needed. There are several tools that can help us so this such as <a href="http://airflow.apache.org/" target="_blank">Airflow</a>, <a href="https://www.prefect.io/" target="_blank">Prefect</a>, <a href="https://dagster.io/" target="_blank">Dagster</a>, <a href="https://luigi.readthedocs.io/en/stable/" target="_blank">Luigi</a>, <a href="https://www.orchest.io/" target="_blank">Orchest</a> and even some ML focused options such as <a href="https://metaflow.org/" target="_blank">Metaflow</a>, <a href="https://flyte.org/" target="_blank">Flyte</a>, <a href="https://www.kubeflow.org/docs/components/pipelines/overview/pipelines-overview/" target="_blank">KubeFlow Pipelines</a>, <a href="https://cloud.google.com/vertex-ai/docs/pipelines/introduction" target="_blank">Vertex pipelines</a>, etc. We'll be creating our workflows using AirFlow for its:</p>
<ul>
<li>wide adoption of the open source platform in industry</li>
<li>Python based software development kit (SDK)</li>
<li>ability to run locally and scale easily</li>
<li>maturity over the years and part of the apache ecosystem</li>
</ul>
<blockquote>
<p>We'll be running Airflow locally but we can easily scale it by running on a managed cluster platform where we can run Python, Hadoop, Spark, etc. on large batch processing jobs (AWS <a href="https://aws.amazon.com/emr/" target="_blank">EMR</a>, Google Cloud's <a href="https://cloud.google.com/dataproc" target="_blank">Dataproc</a>, on-prem hardware, etc.).</p>
</blockquote>
<h2 id="airflow">Airflow</h2>
<p>Before we create our specific pipelines, let's understand and implement <a href="https://airflow.apache.org/" target="_blank">Airflow</a>'s overarching concepts that will allow us to "author, schedule, and monitor workflows".</p>
<div class="admonition note">
<p class="admonition-title">Separate repository</p>
<p>Our work in this lesson will live in a separate repository so create a new directory (outside our <code>mlops-course</code> repository) called <code>data-engineering</code>. All the work in this lesson can be found in our <span class="twemoji github"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span> <a href="https://github.com/GokuMohandas/data-engineering" target="_blank">data-engineering</a> repository.</p>
</div>
<h3 id="set-up">Set up</h3>
<p>To install and run Airflow, we can either do so <a href="https://airflow.apache.org/docs/apache-airflow/stable/start/local.html" target="_blank">locally</a> or with <a href="https://airflow.apache.org/docs/apache-airflow/stable/start/docker.html" target="_blank">Docker</a>. If using <code>docker-compose</code> to run Airflow inside Docker containers, we'll want to allocate at least 4 GB in memory.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Configurations</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">AIRFLOW_HOME</span><span class="o">=</span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/airflow
<span class="nv">AIRFLOW_VERSION</span><span class="o">=</span><span class="m">2</span>.3.3
<span class="nv">PYTHON_VERSION</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>python<span class="w"> </span>--version<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot; &quot;</span><span class="w"> </span>-f<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;.&quot;</span><span class="w"> </span>-f<span class="w"> </span><span class="m">1</span>-2<span class="k">)</span><span class="s2">&quot;</span>
<span class="nv">CONSTRAINT_URL</span><span class="o">=</span><span class="s2">&quot;https://raw.githubusercontent.com/apache/airflow/constraints-</span><span class="si">${</span><span class="nv">AIRFLOW_VERSION</span><span class="si">}</span><span class="s2">/constraints-</span><span class="si">${</span><span class="nv">PYTHON_VERSION</span><span class="si">}</span><span class="s2">.txt&quot;</span>

<span class="c1"># Install Airflow (may need to upgrade pip)</span>
pip<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;apache-airflow==</span><span class="si">${</span><span class="nv">AIRFLOW_VERSION</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>--constraint<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CONSTRAINT_URL</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># Initialize DB (SQLite by default)</span>
airflow<span class="w"> </span>db<span class="w"> </span>init
</code></pre></div>
<p>This will create an <code>airflow</code> directory with the following components:</p>
<div class="highlight"><pre><span></span><code>airflow/
├──<span class="w"> </span>logs/
├──<span class="w"> </span>airflow.cfg
├──<span class="w"> </span>airflow.db
├──<span class="w"> </span>unittests.cfg
└──<span class="w"> </span>webserver_config.py
</code></pre></div>
<p>We're going to edit the <a href="https://github.com/GokuMohandas/data-engineering/blob/main/airflow/airflow.cfg" target="_blank">airflow.cfg</a> file to best fit our needs:
<div class="highlight"><pre><span></span><code><span class="c1"># Inside airflow.cfg</span>
<span class="nv">enable_xcom_pickling</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>True<span class="w">  </span><span class="c1"># needed for Great Expectations airflow provider</span>
<span class="nv">load_examples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>False<span class="w">  </span><span class="c1"># don&#39;t clutter webserver with examples</span>
</code></pre></div></p>
<p>And we'll perform a reset to implement these configuration changes.</p>
<div class="highlight"><pre><span></span><code>airflow<span class="w"> </span>db<span class="w"> </span>reset<span class="w"> </span>-y
</code></pre></div>
<p>Now we're ready to initialize our database with an admin user, which we'll use to login to access our workflows in the webserver.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># We&#39;ll be prompted to enter a password</span>
airflow<span class="w"> </span>users<span class="w"> </span>create<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--username<span class="w"> </span>admin<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--firstname<span class="w"> </span>FIRSTNAME<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--lastname<span class="w"> </span>LASTNAME<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--role<span class="w"> </span>Admin<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--email<span class="w"> </span>EMAIL
</code></pre></div>
<h3 id="webserver">Webserver</h3>
<p>Once we've created a user, we're ready to launch the webserver and log in using our credentials.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Launch webserver</span>
<span class="nb">source</span><span class="w"> </span>venv/bin/activate
<span class="nb">export</span><span class="w"> </span><span class="nv">AIRFLOW_HOME</span><span class="o">=</span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/airflow
airflow<span class="w"> </span>webserver<span class="w"> </span>--port<span class="w"> </span><span class="m">8080</span><span class="w">  </span><span class="c1"># http://localhost:8080</span>
</code></pre></div>
<p>The webserver allows us to run and inspect workflows, establish connections to external data storage, manager users, etc. through a UI. Similarly, we could also use Airflow's <a href="https://airflow.apache.org/docs/apache-airflow/stable/stable-rest-api-ref.html" target="_blank">REST API</a> or <a href="https://airflow.apache.org/docs/apache-airflow/stable/cli-and-env-variables-ref.html" target="_blank">Command-line interface (CLI)</a> to perform the same operations. However, we'll be using the webserver because it's convenient to visually inspect our workflows.</p>
<div class="ai-center-all">
    <img src="/static/images/mlops/orchestration/webserver.png" width="700" alt="airflow webserver">
</div>

<p>We'll explore the different components of the webserver as we learn about Airflow and implement our workflows.</p>
<h3 id="scheduler">Scheduler</h3>
<p>Next, we need to launch our scheduler, which will execute and monitor the tasks in our workflows. The schedule executes tasks by reading from the metadata database and ensures the task has what it needs to finish running. We'll go ahead and execute the following commands on the <em>separate terminal</em> window:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Launch scheduler (in separate terminal)</span>
<span class="nb">source</span><span class="w"> </span>venv/bin/activate
<span class="nb">export</span><span class="w"> </span><span class="nv">AIRFLOW_HOME</span><span class="o">=</span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/airflow
<span class="nb">export</span><span class="w"> </span><span class="nv">OBJC_DISABLE_INITIALIZE_FORK_SAFETY</span><span class="o">=</span>YES
airflow<span class="w"> </span>scheduler
</code></pre></div>
<h3 id="executor">Executor</h3>
<p>As our scheduler reads from the metadata database, the executor determines what worker processes are necessary for the task to run to completion. Since our default database SQLlite, which can't support multiple connections, our default executor is the <a href="https://airflow.apache.org/docs/apache-airflow/stable/executor/sequential.html" target="_blank">Sequential Executor</a>. However, if we choose a more production-grade database option such as PostgresSQL or MySQL, we can choose scalable <a href="https://airflow.apache.org/docs/apache-airflow/stable/executor/index.html#supported-backends" target="_blank">Executor backends</a> Celery, Kubernetes, etc. For example, running <a href="https://airflow.apache.org/docs/apache-airflow/stable/start/docker.html" target="_blank">Airflow with Docker</a> uses PostgresSQL as the database and so uses the Celery Executor backend to run tasks in parallel.</p>
<h2 id="dags">DAGs</h2>
<p>Workflows are defined by directed acyclic graphs (DAGs), whose nodes represent tasks and edges represent the data flow relationship between the tasks. Direct and acyclic implies that workflows can only execute in one direction and a previous, upstream task cannot run again once a downstream task has started.</p>
<div class="ai-center-all">
    <img src="/static/images/mlops/orchestration/basic_dag.png" width="250" alt="basic DAG">
</div>

<p>DAGs can be defined inside Python workflow scripts inside the <code>airflow/dags</code> directory and they'll automatically appear (and continuously be updated) on the webserver. Before we start creating our DataOps and MLOps workflows, we'll learn about Airflow's concepts via an example DAG outlined in <a href="https://github.com/GokuMohandas/data-engineering/blob/main/airflow/dags/example.py" target="_blank">airflow/dags/example.py</a>. Execute the following commands in a new (3rd) terminal window:</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>airflow/dags
touch<span class="w"> </span>airflow/dags/example.py
</code></pre></div>
<p>Inside each workflow script, we can define some default arguments that will apply to all DAGs within that workflow.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Default DAG args</span>
<span class="n">default_args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;airflow&quot;</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<blockquote>
<p>Typically, our DAGs are not the only ones running in an Airflow cluster. However, it can be messy and sometimes impossible to execute different workflows when they require different resources, package versions, etc. For teams with multiple projects, it’s a good idea to use something like the <a href="https://airflow.apache.org/docs/apache-airflow-providers-cncf-kubernetes" target="“_blank”">KubernetesPodOperator</a> to execute each job using an isolated docker image.</p>
</blockquote>
<p>We can initialize DAGs with many <a href="https://airflow.apache.org/docs/apache-airflow/stable/_api/airflow/models/dag/index.html#airflow.models.dag.DAG" target="_blank">parameters</a> (which will override the same parameters in <code>default_args</code>) and in several different ways:</p>
<ul>
<li>
<p>using a <a href="https://docs.python.org/3/reference/compound_stmts.html#the-with-statement" target="_blank">with statement</a>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">airflow</span><span class="w"> </span><span class="kn">import</span> <span class="n">DAG</span>

<span class="k">with</span> <span class="n">DAG</span><span class="p">(</span>
    <span class="n">dag_id</span><span class="o">=</span><span class="s2">&quot;example&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Example DAG&quot;</span><span class="p">,</span>
    <span class="n">default_args</span><span class="o">=</span><span class="n">default_args</span><span class="p">,</span>
    <span class="n">schedule_interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="n">days_ago</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;example&quot;</span><span class="p">],</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">example</span><span class="p">:</span>
    <span class="c1"># Define tasks</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>using the <a href="https://airflow.apache.org/docs/apache-airflow/stable/concepts.html#dag-decorator" target="_blank">dag decorator</a>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">airflow.decorators</span><span class="w"> </span><span class="kn">import</span> <span class="n">dag</span>

<span class="nd">@dag</span><span class="p">(</span>
    <span class="n">dag_id</span><span class="o">=</span><span class="s2">&quot;example&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Example DAG&quot;</span><span class="p">,</span>
    <span class="n">default_args</span><span class="o">=</span><span class="n">default_args</span><span class="p">,</span>
    <span class="n">schedule_interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="n">days_ago</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;example&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">example</span><span class="p">():</span>
    <span class="c1"># Define tasks</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div></p>
</li>
</ul>
<blockquote>
<p>There are many <a href="https://airflow.apache.org/docs/apache-airflow/stable/_api/airflow/models/dag/index.html#airflow.models.dag.DAG" target="_blank">parameters</a> that we can initialize our DAGs with, including a <code>start_date</code> and a <code>schedule_interval</code>. While we could have our workflows execute on a temporal cadence, many ML workflows are initiated by events, which we can map using <a href="https://airflow.apache.org/docs/apache-airflow/stable/_api/airflow/sensors/index.html" target="_blank">sensors</a> and <a href="https://airflow.apache.org/docs/apache-airflow/stable/_api/airflow/hooks/index.html" target="_blank">hooks</a> to external databases, file systems, etc.</p>
</blockquote>
<h2 id="tasks">Tasks</h2>
<p>Tasks are the operations that are executed in a workflow and are represented by nodes in a DAG. Each task should be a clearly defined single operation and it should be idempotent, which means we can execute it multiple times and expect the same result and system state. This is important in the event we need to retry a failed task and don't have to worry about resetting the state of our system. Like DAGs, there are several different ways to implement tasks:</p>
<ul>
<li>
<p>using the <a href="https://airflow.apache.org/docs/apache-airflow/stable/concepts.html#concepts-task-decorator" target="_blank">task decorator</a>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">airflow.decorators</span><span class="w"> </span><span class="kn">import</span> <span class="n">dag</span><span class="p">,</span> <span class="n">task</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">airflow.utils.dates</span><span class="w"> </span><span class="kn">import</span> <span class="n">days_ago</span>

<span class="nd">@dag</span><span class="p">(</span>
    <span class="n">dag_id</span><span class="o">=</span><span class="s2">&quot;example&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Example DAG with task decorators&quot;</span><span class="p">,</span>
    <span class="n">default_args</span><span class="o">=</span><span class="n">default_args</span><span class="p">,</span>
    <span class="n">schedule_interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="n">days_ago</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;example&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">example</span><span class="p">():</span>
    <span class="nd">@task</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">task_1</span><span class="p">():</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="nd">@task</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">task_2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">+</span><span class="mi">1</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>using <a href="https://airflow.apache.org/docs/apache-airflow/stable/_api/airflow/operators/index.html" target="_blank">Operators</a>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">airflow.decorators</span><span class="w"> </span><span class="kn">import</span> <span class="n">dag</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">airflow.operators.bash_operator</span><span class="w"> </span><span class="kn">import</span> <span class="n">BashOperator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">airflow.utils.dates</span><span class="w"> </span><span class="kn">import</span> <span class="n">days_ago</span>

<span class="nd">@dag</span><span class="p">(</span>
    <span class="n">dag_id</span><span class="o">=</span><span class="s2">&quot;example&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Example DAG with Operators&quot;</span><span class="p">,</span>
    <span class="n">default_args</span><span class="o">=</span><span class="n">default_args</span><span class="p">,</span>
    <span class="n">schedule_interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="n">days_ago</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;example&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">example</span><span class="p">():</span>
    <span class="c1"># Define tasks</span>
    <span class="n">task_1</span> <span class="o">=</span> <span class="n">BashOperator</span><span class="p">(</span><span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;task_1&quot;</span><span class="p">,</span> <span class="n">bash_command</span><span class="o">=</span><span class="s2">&quot;echo 1&quot;</span><span class="p">)</span>
    <span class="n">task_2</span> <span class="o">=</span> <span class="n">BashOperator</span><span class="p">(</span><span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;task_2&quot;</span><span class="p">,</span> <span class="n">bash_command</span><span class="o">=</span><span class="s2">&quot;echo 2&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
</li>
</ul>
<blockquote>
<p>Though the graphs are directed, we can establish certain <a href="https://airflow.apache.org/docs/apache-airflow/stable/concepts.html#trigger-rules" target="_blank">trigger rules</a> for each task to execute on conditional successes or failures of the parent tasks.</p>
</blockquote>
<h3 id="operators">Operators</h3>
<p>The first method of creating tasks involved using Operators, which defines what exactly the task will be doing. Airflow has many built-in Operators such as the <a href="https://airflow.apache.org/docs/apache-airflow/stable/_api/airflow/operators/bash/index.html#airflow.operators.bash.BashOperator" target="_blank">BashOperator</a> or <a href="https://airflow.apache.org/docs/apache-airflow/stable/_api/airflow/operators/python/index.html#airflow.operators.python.PythonOperator" target="_blank">PythonOperator</a>, which allow us to execute bash and Python commands respectively.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># BashOperator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">airflow.operators.bash_operator</span><span class="w"> </span><span class="kn">import</span> <span class="n">BashOperator</span>
<span class="n">task_1</span> <span class="o">=</span> <span class="n">BashOperator</span><span class="p">(</span><span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;task_1&quot;</span><span class="p">,</span> <span class="n">bash_command</span><span class="o">=</span><span class="s2">&quot;echo 1&quot;</span><span class="p">)</span>

<span class="c1"># PythonOperator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">airflow.operators.python</span><span class="w"> </span><span class="kn">import</span> <span class="n">PythonOperator</span>
<span class="n">task_2</span> <span class="o">=</span> <span class="n">PythonOperator</span><span class="p">(</span>
    <span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;task_2&quot;</span><span class="p">,</span>
    <span class="n">python_callable</span><span class="o">=</span><span class="n">foo</span><span class="p">,</span>
    <span class="n">op_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;arg1&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<p>There are also many other Airflow native <a href="https://airflow.apache.org/docs/apache-airflow/stable/_api/airflow/operators/index.html" target="_blank">Operators</a> (email, S3, MySQL, Hive, etc.), as well as <a href="https://airflow.apache.org/docs/apache-airflow-providers/packages-ref.html" target="_blank">community maintained provider packages</a> (Kubernetes, Snowflake, Azure, AWS, Salesforce, Tableau, etc.), to execute tasks specific to certain platforms or tools.</p>
<blockquote>
<p>We can also create our own <a href="https://airflow.apache.org/docs/apache-airflow/stable/howto/custom-operator.html" target="_blank">custom Operators</a> by extending the <a href="https://airflow.apache.org/docs/apache-airflow/stable/_api/airflow/operators/bash/index.html#airflow.operators.bash.BashOperator" target="_blank">BashOperator</a> class.</p>
</blockquote>
<h3 id="relationships">Relationships</h3>
<p>Once we've defined our tasks using Operators or as decorated functions, we need to define the relationships between them (edges). The way we define the relationships depends on how our tasks were defined:</p>
<ul>
<li>
<p>using decorated functions
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Task relationships</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">task_1</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">task_2</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>using Operators
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Task relationships</span>
<span class="n">task_1</span> <span class="o">&gt;&gt;</span> <span class="n">task_2</span>  <span class="c1"># same as task_1.set_downstream(task_2) or</span>
                  <span class="c1"># task_2.set_upstream(task_1)</span>
</code></pre></div></td></tr></table></div></p>
</li>
</ul>
<p>In both scenarios, we'll setting <code>task_2</code> as the downstream task to <code>task_1</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We can even create intricate DAGs by using these notations to define the relationships.</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">task_1</span> <span class="o">&gt;&gt;</span> <span class="p">[</span><span class="n">task_2_1</span><span class="p">,</span> <span class="n">task_2_2</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">task_3</span>
<span class="n">task_2_2</span> <span class="o">&gt;&gt;</span> <span class="n">task_4</span>
<span class="p">[</span><span class="n">task_3</span><span class="p">,</span> <span class="n">task_4</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">task_5</span>
</code></pre></div></td></tr></table></div>
<div class="ai-center-all">
    <img src="/static/images/mlops/orchestration/dag.png" width="500" alt="DAG">
</div></p>
</div>
<h3 id="xcoms">XComs</h3>
<p>When we use task decorators, we can see how values can be passed between tasks. But, how can we pass values when using Operators? Airflow uses XComs (cross communications) objects, defined with a key, value, timestamp and task_id, to push and pull values between tasks. When we use decorated functions, XComs are being used under the hood but it's abstracted away, allowing us to pass values amongst Python functions seamlessly. But when using Operators, we'll need to explicitly push and pull the values as we need it.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_task_1</span><span class="p">(</span><span class="n">ti</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">2</span>
<span class="hll">    <span class="n">ti</span><span class="o">.</span><span class="n">xcom_push</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_task_2</span><span class="p">(</span><span class="n">ti</span><span class="p">):</span>
<span class="hll">    <span class="n">x</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">xcom_pull</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">task_ids</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;task_1&quot;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span>    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">3</span>
<span class="hll">    <span class="n">ti</span><span class="o">.</span><span class="n">xcom_push</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
</span>
<span class="nd">@dag</span><span class="p">(</span>
    <span class="n">dag_id</span><span class="o">=</span><span class="s2">&quot;example&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Example DAG&quot;</span><span class="p">,</span>
    <span class="n">default_args</span><span class="o">=</span><span class="n">default_args</span><span class="p">,</span>
    <span class="n">schedule_interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="n">days_ago</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;example&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">example2</span><span class="p">():</span>
    <span class="c1"># Tasks</span>
    <span class="n">task_1</span> <span class="o">=</span> <span class="n">PythonOperator</span><span class="p">(</span><span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;task_1&quot;</span><span class="p">,</span> <span class="n">python_callable</span><span class="o">=</span><span class="n">_task_1</span><span class="p">)</span>
    <span class="n">task_2</span> <span class="o">=</span> <span class="n">PythonOperator</span><span class="p">(</span><span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;task_2&quot;</span><span class="p">,</span> <span class="n">python_callable</span><span class="o">=</span><span class="n">_task_2</span><span class="p">)</span>
    <span class="n">task_1</span> <span class="o">&gt;&gt;</span> <span class="n">task_2</span>
</code></pre></div></td></tr></table></div>
<p>We can also view our XComs on the webserver by going to <strong>Admin</strong> &gt;&gt; <strong>XComs</strong>:</p>
<div class="ai-center-all">
    <img src="/static/images/mlops/orchestration/xcoms.png" width="700" alt="xcoms">
</div>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The data we pass between tasks should be small (metadata, metrics, etc.) because Airflow's metadata database is not equipped to hold large artifacts. However, if we do need to store and use the large results of our tasks, it's best to use an external data storage (blog storage, model registry, etc.) and perform heavy processing using Spark or inside data systems like a data warehouse.</p>
</div>
<h2 id="dag-runs">DAG runs</h2>
<p>Once we've defined the tasks and their relationships, we're ready to run our DAGs. We'll start defining our DAG like so:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Run DAGs</span>
<span class="n">example1_dag</span> <span class="o">=</span> <span class="n">example_1</span><span class="p">()</span>
<span class="n">example2_dag</span> <span class="o">=</span> <span class="n">example_2</span><span class="p">()</span>
</code></pre></div></td></tr></table></div></p>
<p>The new DAG will have appeared when we refresh our <a href="http://localhost:8080/" target="_blank">Airflow webserver</a>.</p>
<h3 id="manual">Manual</h3>
<p>Our DAG is initially paused since we specified <code>dags_are_paused_at_creation = True</code> inside our <a href="https://github.com/GokuMohandas/data-engineering/blob/main/airflow/airflow.cfg" target="_blank">airflow.cfg</a> configuration, so we'll have to manually execute this DAG by clicking on it &gt; unpausing it (toggle) &gt; triggering it (button). To view the logs for any of the tasks in our DAG run, we can click on the task &gt; Log.</p>
<div class="ai-center-all">
    <img src="/static/images/mlops/orchestration/trigger.png" width="700" alt="triggering a DAG">
</div>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We could also use Airflow's <a href="https://airflow.apache.org/docs/apache-airflow/stable/stable-rest-api-ref.html" target="_blank">REST API</a> (will <a href="https://airflow.apache.org/docs/apache-airflow/stable/security/api.html" target="_blank">configured authorization</a>) or <a href="https://airflow.apache.org/docs/apache-airflow/stable/cli-and-env-variables-ref.html" target="_blank">Command-line interface (CLI)</a> to inspect and trigger workflows (and a whole lot more). Or we could even use the <a href="https://airflow.apache.org/docs/apache-airflow/stable/_api/airflow/operators/trigger_dagrun/index.html" target="_blank"><code>trigger_dagrun</code></a> Operator to trigger DAGs from within another workflow.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># CLI to run dags</span>
airflow<span class="w"> </span>dags<span class="w"> </span>trigger<span class="w"> </span>&lt;DAG_ID&gt;
</code></pre></div>
</div>
<h3 id="interval">Interval</h3>
<p>Had we specified a <code>start_date</code> and <code>schedule_interval</code> when defining the DAG, it would have have automatically executed at the appropriate times. For example, the DAG below will have started two days ago and will be triggered at the start of every day.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">airflow.decorators</span><span class="w"> </span><span class="kn">import</span> <span class="n">dag</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">airflow.utils.dates</span><span class="w"> </span><span class="kn">import</span> <span class="n">days_ago</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">timedelta</span>

<span class="nd">@dag</span><span class="p">(</span>
    <span class="n">dag_id</span><span class="o">=</span><span class="s2">&quot;example&quot;</span><span class="p">,</span>
    <span class="n">default_args</span><span class="o">=</span><span class="n">default_args</span><span class="p">,</span>
    <span class="n">schedule_interval</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">start_date</span><span class="o">=</span><span class="n">days_ago</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;example&quot;</span><span class="p">],</span>
    <span class="n">catch_up</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Depending on the <code>start_date</code> and <code>schedule_interval</code>, our workflow should have been triggered several times and Airflow will try to <a href="https://airflow.apache.org/docs/apache-airflow/stable/dag-run.html#catchup" target="_blank">catchup</a> to the current time. We can avoid this by setting <code>catchup=False</code> when defining the DAG. We can also set this configuration as part of the default arguments:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">default_args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;airflow&quot;</span><span class="p">,</span>
<span class="hll">    <span class="s2">&quot;catch_up&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>However, if we did want to run particular runs in the past, we can manually <a href="https://airflow.apache.org/docs/apache-airflow/stable/dag-run.html#backfill" target="_blank">backfill</a> what we need.</p>
</div>
<p>We could also specify a <a href="https://crontab.guru/" target="_blank">cron</a> expression for our <code>schedule_interval</code> parameter or even use <a href="https://airflow.apache.org/docs/apache-airflow/stable/dag-run.html#cron-presets" target="_blank">cron presets</a>.</p>
<blockquote>
<p>Airflow's Scheduler will run our workflows one <code>schedule_interval</code> from the <code>start_date</code>. For example, if we want our workflow to start on <code>01-01-1983</code> and run <code>@daily</code>, then the first run will be immediately after <code>01-01-1983T11:59</code>.</p>
</blockquote>
<h3 id="sensors">Sensors</h3>
<p>While it may make sense to execute many data processing workflows on a scheduled interval, machine learning workflows may require more nuanced triggers. We shouldn't be wasting compute by running executing our workflows <em>just in case</em> we have new data. Instead, we can use <a href="https://airflow.apache.org/docs/apache-airflow/stable/_api/airflow/sensors/" target="_blank">sensors</a> to trigger workflows when some external condition is met. For example, we can initiate data processing when a new batch of annotated data appears in a database or when a specific file appears in a file system, etc.</p>
<blockquote>
<p>There's so much more to Airflow (monitoring, Task groups, smart senors, etc.) so be sure to explore them as you need them by using the <a href="https://airflow.apache.org/docs/apache-airflow/stable/index.html" target="_blank">official documentation</a>.</p>
</blockquote>
<h2 id="dataops">DataOps</h2>
<p>Now that we've reviewed Airflow's major concepts, we're ready to create the DataOps workflows. It's the exact same workflow we defined in our <a href="../data-engineering/" target="_blank">data stack lesson</a> -- extract, load and transform -- but this time we'll be doing everything programmatically and orchestrating it with Airflow.</p>
<div class="ai-center-all mb-4">
    <img width="650" src="/static/images/mlops/testing/production.png" alt=ELT pipelines in production">
</div>

<p>We'll start by creating the script where we'll define our workflows:</p>
<div class="highlight"><pre><span></span><code>touch<span class="w"> </span>airflow/dags/workflows.py
</code></pre></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">airflow.decorators</span><span class="w"> </span><span class="kn">import</span> <span class="n">dag</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">airflow.utils.dates</span><span class="w"> </span><span class="kn">import</span> <span class="n">days_ago</span>

<span class="c1"># Default DAG args</span>
<span class="n">default_args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;airflow&quot;</span><span class="p">,</span>
    <span class="s2">&quot;catch_up&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">BASE_DIR</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>

<span class="nd">@dag</span><span class="p">(</span>
    <span class="n">dag_id</span><span class="o">=</span><span class="s2">&quot;dataops&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;DataOps workflows.&quot;</span><span class="p">,</span>
    <span class="n">default_args</span><span class="o">=</span><span class="n">default_args</span><span class="p">,</span>
    <span class="n">schedule_interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="n">days_ago</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;dataops&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">dataops</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;DataOps workflows.&quot;&quot;&quot;</span>
    <span class="k">pass</span>

<span class="c1"># Run DAG</span>
<span class="n">do</span> <span class="o">=</span> <span class="n">dataops</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<p>In two separate terminals, activate the virtual environment and spin up the Airflow webserver and scheduler:</p>
<div class="row">
    <div class="col-md-6">
<div class="highlight"><pre id="__code_2"><span></span><button class="md-clipboard md-icon" title="Copy to clipboard" data-clipboard-target="#__code_2 > code"></button><code tabindex="0"><span class="c1"># Airflow webserver</span>
<span class="nb">source</span> venv/bin/activate
<span class="nb">export</span> <span class="nv">AIRFLOW_HOME</span><span class="o">=</span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/airflow
<span class="nb">export</span> <span class="nv">GOOGLE_APPLICATION_CREDENTIALS</span><span class="o">=</span>/Users/goku/Downloads/made-with-ml-XXXXXX-XXXXXXXXXXXX.json <span class="c1"># REPLACE</span>
airflow webserver --port <span class="m">8080</span>
<span class="c1"># Go to http://localhost:8080</span>
</code></pre></div>
    </div>
    <div class="col-md-6">
<div class="highlight"><pre id="__code_3"><span></span><button class="md-clipboard md-icon" title="Copy to clipboard" data-clipboard-target="#__code_3 > code"></button><code tabindex="0"><span class="c1"># Airflow scheduler</span>
<span class="nb">source</span> venv/bin/activate
<span class="nb">export</span> <span class="nv">AIRFLOW_HOME</span><span class="o">=</span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/airflow
<span class="nb">export</span> <span class="nv">OBJC_DISABLE_INITIALIZE_FORK_SAFETY</span><span class="o">=</span>YES
<span class="nb">export</span> <span class="nv">GOOGLE_APPLICATION_CREDENTIALS</span><span class="o">=</span>~/Downloads/made-with-ml-XXXXXX-XXXXXXXXXXXX.json <span class="c1"># REPLACE</span>
airflow scheduler
</code></pre></div>
    </div>
</div>

<h3 id="extract-and-load">Extract and load</h3>
<p>We're going to use the Airbyte connections we set up in our <a href="../data-engineering/" target="_blank">data-stack lesson</a> but this time we're going to programmatically trigger the data syncs with Airflow. First, let's ensure that Airbyte is running on a separate terminal in it's repository:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/airbytehq/airbyte.git<span class="w">  </span><span class="c1"># skip if already create in data-stack lesson</span>
<span class="nb">cd</span><span class="w"> </span>airbyte
docker-compose<span class="w"> </span>up
</code></pre></div>
<p>Next, let's install the required packages and establish the connection between Airbyte and Airflow:</p>
<div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>apache-airflow-providers-airbyte<span class="o">==</span><span class="m">3</span>.1.0
</code></pre></div>
<ol>
<li>Go to the <a href="http://localhost:8080/" target="_blank">Airflow webserver</a> and click <code>Admin</code> &gt; <code>Connections</code> &gt; ➕</li>
<li>Add the connection with the following details:
<div class="highlight"><pre><span></span><code><span class="nt">Connection ID</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">airbyte</span>
<span class="nt">Connection Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HTTP</span>
<span class="nt">Host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">localhost</span>
<span class="nt">Port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
</code></pre></div></li>
</ol>
<blockquote>
<p>We could also establish connections <a href="https://airflow.apache.org/docs/apache-airflow/stable/howto/connection.html#connection-cli" target="“_blank”">programmatically</a> but it’s good to use the UI to understand what’s happening under the hood.</p>
</blockquote>
<p>In order to execute our extract and load data syncs, we can use the <a href="https://airflow.apache.org/docs/apache-airflow-providers-airbyte/stable/operators/airbyte.html" target="_blank"><code>AirbyteTriggerSyncOperator</code></a>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dag</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">dataops</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Production DataOps workflows.&quot;&quot;&quot;</span>
    <span class="c1"># Extract + Load</span>
    <span class="n">extract_and_load_projects</span> <span class="o">=</span> <span class="n">AirbyteTriggerSyncOperator</span><span class="p">(</span>
        <span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;extract_and_load_projects&quot;</span><span class="p">,</span>
        <span class="n">airbyte_conn_id</span><span class="o">=</span><span class="s2">&quot;airbyte&quot;</span><span class="p">,</span>
        <span class="n">connection_id</span><span class="o">=</span><span class="s2">&quot;XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX&quot;</span><span class="p">,</span>  <span class="c1"># REPLACE</span>
        <span class="n">asynchronous</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">timeout</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span>
        <span class="n">wait_seconds</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">extract_and_load_tags</span> <span class="o">=</span> <span class="n">AirbyteTriggerSyncOperator</span><span class="p">(</span>
        <span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;extract_and_load_tags&quot;</span><span class="p">,</span>
        <span class="n">airbyte_conn_id</span><span class="o">=</span><span class="s2">&quot;airbyte&quot;</span><span class="p">,</span>
        <span class="n">connection_id</span><span class="o">=</span><span class="s2">&quot;XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX&quot;</span><span class="p">,</span>  <span class="c1"># REPLACE</span>
        <span class="n">asynchronous</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">timeout</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span>
        <span class="n">wait_seconds</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Define DAG</span>
    <span class="n">extract_and_load_projects</span>
    <span class="n">extract_and_load_tags</span>
</code></pre></div></td></tr></table></div>
<p>We can find the <code>connection_id</code> for each Airbyte connection by:</p>
<ol>
<li>Go to our <a href="http://localhost:8000/" target="_blank">Airbyte webserver</a> and click <code>Connections</code> on the left menu.</li>
<li>Click on the specific connection we want to use and the URL should be like this:
<div class="highlight"><pre><span></span><code>https://demo.airbyte.io/workspaces/&lt;WORKSPACE_ID&gt;/connections/&lt;CONNECTION_ID&gt;/status
</code></pre></div></li>
<li>The string in the <code>CONNECTION_ID</code> position is the connection's id.</li>
</ol>
<p>We can trigger our DAG right now and view the extracted data be loaded into our BigQuery data warehouse but we'll continue developing and execute our DAG once the entire DataOps workflow has been defined.</p>
<h3 id="validate">Validate</h3>
<p>The specific process of where and how we extract our data can be bespoke but what's important is that we have validation at every step of the way. We'll once again use <a href="https://greatexpectations.io/" target="_blank">Great Expectations</a>, as we did in our <a href="../testing/#data" target="_blank">testing lesson</a>, to <a href="../testing/#expectations" target="_blank">validate</a> our extracted and loaded data before transforming it.</p>
<p>With the Airflow concepts we've learned so far, there are many ways to use our data validation library to validate our data. Regardless of what data validation tool we use (ex. <a href="https://greatexpectations.io/" target="_blank">Great Expectations</a>, <a href="https://www.tensorflow.org/tfx/data_validation/get_started" target="_blank">TFX</a>, <a href="https://github.com/awslabs/deequ" target="_blank">AWS Deequ</a>, etc.) we could use the BashOperator, PythonOperator, etc. to run our tests. However, Great Expectations has a <a href="https://github.com/great-expectations/airflow-provider-great-expectations" target="_blank">Airflow Provider package</a> to make it even easier to validate our data. This package contains a <a href="https://registry.astronomer.io/providers/great-expectations/modules/greatexpectationsoperator" target="_blank"><code>GreatExpectationsOperator</code></a> which we can use to execute specific checkpoints as tasks.</p>
<div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>airflow-provider-great-expectations<span class="o">==</span><span class="m">0</span>.1.1<span class="w"> </span>great-expectations<span class="o">==</span><span class="m">0</span>.15.19
great_expectations<span class="w"> </span>init
</code></pre></div>
<p>This will create the following directory within our data-engineering repository:</p>
<div class="highlight"><pre><span></span><code>tests/great_expectations/
├──<span class="w"> </span>checkpoints/
├──<span class="w"> </span>expectations/
├──<span class="w"> </span>plugins/
├──<span class="w"> </span>uncommitted/
├──<span class="w"> </span>.gitignore
└──<span class="w"> </span>great_expectations.yml
</code></pre></div>
<h4 id="data-source">Data source</h4>
<p>But first, before we can create our tests, we need to define a new <code>datasource</code> within Great Expectations for our Google BigQuery data warehouse. This will require several packages and exports:</p>
<div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span><span class="nv">pybigquery</span><span class="o">==</span><span class="m">0</span>.10.2<span class="w"> </span><span class="nv">sqlalchemy_bigquery</span><span class="o">==</span><span class="m">1</span>.4.4
<span class="nb">export</span><span class="w"> </span><span class="nv">GOOGLE_APPLICATION_CREDENTIALS</span><span class="o">=</span>/Users/goku/Downloads/made-with-ml-XXXXXX-XXXXXXXXXXXX.json<span class="w">  </span><span class="c1"># REPLACE</span>
</code></pre></div>
<p><div class="highlight"><pre><span></span><code>great_expectations<span class="w"> </span>datasource<span class="w"> </span>new
</code></pre></div>
<div class="highlight"><pre><span></span><code>What<span class="w"> </span>data<span class="w"> </span>would<span class="w"> </span>you<span class="w"> </span>like<span class="w"> </span>Great<span class="w"> </span>Expectations<span class="w"> </span>to<span class="w"> </span>connect<span class="w"> </span>to?
<span class="w">    </span><span class="m">1</span>.<span class="w"> </span>Files<span class="w"> </span>on<span class="w"> </span>a<span class="w"> </span>filesystem<span class="w"> </span><span class="o">(</span><span class="k">for</span><span class="w"> </span>processing<span class="w"> </span>with<span class="w"> </span>Pandas<span class="w"> </span>or<span class="w"> </span>Spark<span class="o">)</span>
<span class="w">    </span><span class="m">2</span>.<span class="w"> </span>Relational<span class="w"> </span>database<span class="w"> </span><span class="o">(</span>SQL<span class="o">)</span><span class="w"> </span>👈
</code></pre></div>
<div class="highlight"><pre><span></span><code>What<span class="w"> </span>are<span class="w"> </span>you<span class="w"> </span>processing<span class="w"> </span>your<span class="w"> </span>files<span class="w"> </span>with?
<span class="m">1</span>.<span class="w"> </span>MySQL
<span class="m">2</span>.<span class="w"> </span>Postgres
<span class="m">3</span>.<span class="w"> </span>Redshift
<span class="m">4</span>.<span class="w"> </span>Snowflake
<span class="m">5</span>.<span class="w"> </span>BigQuery<span class="w"> </span>👈
<span class="m">6</span>.<span class="w"> </span>other<span class="w"> </span>-<span class="w"> </span>Do<span class="w"> </span>you<span class="w"> </span>have<span class="w"> </span>a<span class="w"> </span>working<span class="w"> </span>SQLAlchemy<span class="w"> </span>connection<span class="w"> </span>string?
</code></pre></div></p>
<p>This will open up an interactive notebook where we can fill in the following details:
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">datasource_name = “dwh&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">connection_string = “bigquery://made-with-ml-359923/mlops_course”</span>
</code></pre></div></p>
<h4 id="suite">Suite</h4>
<p>Next, we can create a <a href="../testing/#suites" target="_blank">suite of expectations</a> for our data assets:</p>
<div class="highlight"><pre><span></span><code>great_expectations<span class="w"> </span>suite<span class="w"> </span>new
</code></pre></div>
<p><div class="highlight"><pre><span></span><code>How<span class="w"> </span>would<span class="w"> </span>you<span class="w"> </span>like<span class="w"> </span>to<span class="w"> </span>create<span class="w"> </span>your<span class="w"> </span>Expectation<span class="w"> </span>Suite?
<span class="w">    </span><span class="m">1</span>.<span class="w"> </span>Manually,<span class="w"> </span>without<span class="w"> </span>interacting<span class="w"> </span>with<span class="w"> </span>a<span class="w"> </span>sample<span class="w"> </span>batch<span class="w"> </span>of<span class="w"> </span>data<span class="w"> </span><span class="o">(</span>default<span class="o">)</span>
<span class="w">    </span><span class="m">2</span>.<span class="w"> </span>Interactively,<span class="w"> </span>with<span class="w"> </span>a<span class="w"> </span>sample<span class="w"> </span>batch<span class="w"> </span>of<span class="w"> </span>data<span class="w"> </span>👈
<span class="w">    </span><span class="m">3</span>.<span class="w"> </span>Automatically,<span class="w"> </span>using<span class="w"> </span>a<span class="w"> </span>profiler
</code></pre></div>
<div class="highlight"><pre><span></span><code>Select<span class="w"> </span>a<span class="w"> </span>datasource
<span class="w">    </span><span class="m">1</span>.<span class="w"> </span>dwh<span class="w"> </span>👈
</code></pre></div>
<div class="highlight"><pre><span></span><code>Which<span class="w"> </span>data<span class="w"> </span>asset<span class="w"> </span><span class="o">(</span>accessible<span class="w"> </span>by<span class="w"> </span>data<span class="w"> </span>connector<span class="w"> </span><span class="s2">&quot;default_inferred_data_connector_name&quot;</span><span class="o">)</span><span class="w"> </span>would<span class="w"> </span>you<span class="w"> </span>like<span class="w"> </span>to<span class="w"> </span>use?
<span class="w">    </span><span class="m">1</span>.<span class="w"> </span>mlops_course.projects<span class="w"> </span>👈
<span class="w">    </span><span class="m">2</span>.<span class="w"> </span>mlops_course.tags
</code></pre></div>
<div class="highlight"><pre><span></span><code>Name<span class="w"> </span>the<span class="w"> </span>new<span class="w"> </span>Expectation<span class="w"> </span>Suite<span class="w"> </span><span class="o">[</span>mlops.projects.warning<span class="o">]</span>:<span class="w"> </span>projects
</code></pre></div></p>
<p>This will open up an interactive notebook where we can define our expectations. Repeat the same for creating a suite for our tags data asset as well.</p>
<details class="quote">
<summary>Expectations for <code>mlops_course.projects</code></summary>
<p>Table expectations
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># data leak</span>
<span class="n">validator</span><span class="o">.</span><span class="n">expect_compound_columns_to_be_unique</span><span class="p">(</span><span class="n">column_list</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">])</span>
</code></pre></div></td></tr></table></div></p>
<p>Column expectations:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># id</span>
<span class="n">validator</span><span class="o">.</span><span class="n">expect_column_values_to_be_unique</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>

<span class="c1"># create_on</span>
<span class="n">validator</span><span class="o">.</span><span class="n">expect_column_values_to_not_be_null</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;created_on&quot;</span><span class="p">)</span>

<span class="c1"># title</span>
<span class="n">validator</span><span class="o">.</span><span class="n">expect_column_values_to_not_be_null</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;title&quot;</span><span class="p">)</span>
<span class="n">validator</span><span class="o">.</span><span class="n">expect_column_values_to_be_of_type</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="s2">&quot;STRING&quot;</span><span class="p">)</span>

<span class="c1"># description</span>
<span class="n">validator</span><span class="o">.</span><span class="n">expect_column_values_to_not_be_null</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;description&quot;</span><span class="p">)</span>
<span class="n">validator</span><span class="o">.</span><span class="n">expect_column_values_to_be_of_type</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="s2">&quot;STRING&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
</details>
<details class="quote">
<summary>Expectations for <code>mlops_course.tags</code></summary>
<p>Column expectations:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># id</span>
<span class="n">validator</span><span class="o">.</span><span class="n">expect_column_values_to_be_unique</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>

<span class="c1"># tag</span>
<span class="n">validator</span><span class="o">.</span><span class="n">expect_column_values_to_not_be_null</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;tag&quot;</span><span class="p">)</span>
<span class="n">validator</span><span class="o">.</span><span class="n">expect_column_values_to_be_of_type</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;tag&quot;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="s2">&quot;STRING&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
</details>
<h4 id="checkpoints">Checkpoints</h4>
<p>Once we have our suite of expectations, we're ready to check <a href="../testing/#checkpoints" target="_blank">checkpoints</a> to execute these expectations:</p>
<div class="highlight"><pre><span></span><code>great_expectations<span class="w"> </span>checkpoint<span class="w"> </span>new<span class="w"> </span>projects
</code></pre></div>
<p>This will, of course, open up an interactive notebook. Just ensure that the following information is correct (the default values may not be):
<div class="highlight"><pre><span></span><code><span class="nt">datasource_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dwh</span>
<span class="nt">data_asset_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mlops_course.projects</span>
<span class="nt">expectation_suite_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">projects</span>
</code></pre></div></p>
<p>And repeat the same for creating a checkpoint for our tags suite.</p>
<h4 id="tasks_1">Tasks</h4>
<p>With our checkpoints defined, we're ready to apply them to our data assets in our warehouse.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">GE_ROOT_DIR</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s2">&quot;great_expectations&quot;</span><span class="p">)</span>

<span class="nd">@dag</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">dataops</span><span class="p">():</span>
    <span class="o">...</span>
    <span class="n">validate_projects</span> <span class="o">=</span> <span class="n">GreatExpectationsOperator</span><span class="p">(</span>
        <span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;validate_projects&quot;</span><span class="p">,</span>
        <span class="n">checkpoint_name</span><span class="o">=</span><span class="s2">&quot;projects&quot;</span><span class="p">,</span>
        <span class="n">data_context_root_dir</span><span class="o">=</span><span class="n">GE_ROOT_DIR</span><span class="p">,</span>
        <span class="n">fail_task_on_validation_failure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">validate_tags</span> <span class="o">=</span> <span class="n">GreatExpectationsOperator</span><span class="p">(</span>
        <span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;validate_tags&quot;</span><span class="p">,</span>
        <span class="n">checkpoint_name</span><span class="o">=</span><span class="s2">&quot;tags&quot;</span><span class="p">,</span>
        <span class="n">data_context_root_dir</span><span class="o">=</span><span class="n">GE_ROOT_DIR</span><span class="p">,</span>
        <span class="n">fail_task_on_validation_failure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Define DAG</span>
    <span class="n">extract_and_load_projects</span> <span class="o">&gt;&gt;</span> <span class="n">validate_projects</span>
    <span class="n">extract_and_load_tags</span> <span class="o">&gt;&gt;</span> <span class="n">validate_tags</span>
</code></pre></div></td></tr></table></div>
<h3 id="transform">Transform</h3>
<p>Once we've validated our extracted and loaded data, we're ready to <a href="../data-engineering/#transform" target="_blank">transform</a> it. Our DataOps workflows are not specific to any particular downstream application so the transformation must be globally relevant (ex. cleaning missing data, aggregation, etc.). Just like in our <a href="../data-engineering/" target="_blank">data stack lesson</a>, we're going to use <a href="https://www.getdbt.com/" target="_blank">dbt</a> to transform our data. However, this time, we're going to do everything programmatically using the open-source <a href="https://github.com/dbt-labs/dbt-core" target="_blank">dbt-core</a> package.</p>
<p>In the root of our data-engineering repository, initialize our dbt directory with the following command:
<div class="highlight"><pre><span></span><code>dbt<span class="w"> </span>init<span class="w"> </span>dbf_transforms
</code></pre></div>
<div class="highlight"><pre><span></span><code>Which<span class="w"> </span>database<span class="w"> </span>would<span class="w"> </span>you<span class="w"> </span>like<span class="w"> </span>to<span class="w"> </span>use?
<span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span>bigquery<span class="w"> </span>👈
</code></pre></div>
<div class="highlight"><pre><span></span><code>Desired<span class="w"> </span>authentication<span class="w"> </span>method<span class="w"> </span>option:
<span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span>oauth
<span class="o">[</span><span class="m">2</span><span class="o">]</span><span class="w"> </span>service_account<span class="w"> </span>👈
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nt">keyfile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/Users/goku/Downloads/made-with-ml-XXXXXX-XXXXXXXXXXXX.json</span><span class="w">  </span><span class="c1"># REPLACE</span>
<span class="nt">project (GCP project id)</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">made-with-ml-XXXXXX</span><span class="w">  </span><span class="c1"># REPLACE</span>
<span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mlops_course</span>
<span class="nt">threads</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">job_execution_timeout_seconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">300</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>Desired<span class="w"> </span>location<span class="w"> </span>option:
<span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span>US<span class="w">  </span>👈<span class="w">  </span><span class="c1"># or what you picked when defining your dataset in Airbyte DWH destination setup</span>
<span class="o">[</span><span class="m">2</span><span class="o">]</span><span class="w"> </span>EU
</code></pre></div></p>
<h4 id="models">Models</h4>
<p>We'll prepare our dbt models as we did using the <a href="../data-engineering/#dbt-cloud" target="_blank">dbt Cloud IDE</a> in the previous lesson.</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>dbt_transforms
rm<span class="w"> </span>-rf<span class="w"> </span>models/example
mkdir<span class="w"> </span>models/labeled_projects
touch<span class="w"> </span>models/labeled_projects/labeled_projects.sql
touch<span class="w"> </span>models/labeled_projects/schema.yml
</code></pre></div>
<p>and add the following code to our model files:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">-- models/labeled_projects/labeled_projects.sql</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">created_on</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="p">,</span><span class="w"> </span><span class="n">description</span><span class="p">,</span><span class="w"> </span><span class="n">tag</span>
<span class="k">FROM</span><span class="w"> </span><span class="o">`</span><span class="n">made</span><span class="o">-</span><span class="k">with</span><span class="o">-</span><span class="n">ml</span><span class="o">-</span><span class="n">XXXXXX</span><span class="p">.</span><span class="n">mlops_course</span><span class="p">.</span><span class="n">projects</span><span class="o">`</span><span class="w"> </span><span class="n">p</span><span class="w">  </span><span class="c1">-- REPLACE</span>
<span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="o">`</span><span class="n">made</span><span class="o">-</span><span class="k">with</span><span class="o">-</span><span class="n">ml</span><span class="o">-</span><span class="n">XXXXXX</span><span class="p">.</span><span class="n">mlops_course</span><span class="p">.</span><span class="n">tags</span><span class="o">`</span><span class="w"> </span><span class="n">t</span><span class="w">  </span><span class="c1">-- REPLACE</span>
<span class="k">ON</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">id</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># models/labeled_projects/schema.yml</span>

<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>

<span class="nt">models</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">labeled_projects</span>
<span class="w">      </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Tags</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">all</span><span class="nv"> </span><span class="s">projects&quot;</span>
<span class="w">      </span><span class="nt">columns</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">id</span>
<span class="w">            </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Unique</span><span class="nv"> </span><span class="s">ID</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">project.&quot;</span>
<span class="w">            </span><span class="nt">tests</span><span class="p">:</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unique</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">title</span>
<span class="w">            </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Title</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">project.&quot;</span>
<span class="w">            </span><span class="nt">tests</span><span class="p">:</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description</span>
<span class="w">            </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Description</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">project.&quot;</span>
<span class="w">            </span><span class="nt">tests</span><span class="p">:</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag</span>
<span class="w">            </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Labeled</span><span class="nv"> </span><span class="s">tag</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">project.&quot;</span>
<span class="w">            </span><span class="nt">tests</span><span class="p">:</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null</span>
</code></pre></div></td></tr></table></div>
<p>And we can use the BashOperator to execute our dbt commands like so:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">DBT_ROOT_DIR</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s2">&quot;dbt_transforms&quot;</span><span class="p">)</span>

<span class="nd">@dag</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">dataops</span><span class="p">():</span>
    <span class="o">...</span>
    <span class="c1"># Transform</span>
    <span class="n">transform</span> <span class="o">=</span> <span class="n">BashOperator</span><span class="p">(</span><span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;transform&quot;</span><span class="p">,</span> <span class="n">bash_command</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;cd </span><span class="si">{</span><span class="n">DBT_ROOT_DIR</span><span class="si">}</span><span class="s2"> &amp;&amp; dbt run &amp;&amp; dbt test&quot;</span><span class="p">)</span>

    <span class="c1"># Define DAG</span>
    <span class="n">extract_and_load_projects</span> <span class="o">&gt;&gt;</span> <span class="n">validate_projects</span>
    <span class="n">extract_and_load_tags</span> <span class="o">&gt;&gt;</span> <span class="n">validate_tags</span>
    <span class="p">[</span><span class="n">validate_projects</span><span class="p">,</span> <span class="n">validate_tags</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">transform</span>
</code></pre></div></td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Programmatically using dbt Cloud</p>
<p>While we developed locally, we could just as easily use Airflow’s <a href="https://airflow.apache.org/docs/apache-airflow-providers-dbt-cloud/" target="“blank”">dbt cloud provider</a> to connect to our dbt cloud and use the different operators to schedule jobs. This is recommended for production because we can design jobs with proper environment, authentication, schemas, etc.</p>
<ul>
<li>Connect Airflow with dbt Cloud:</li>
</ul>
<p>Go to Admin &gt; Connections &gt; +
<div class="highlight"><pre><span></span><code><span class="nt">Connection ID</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dbt_cloud_default</span>
<span class="nt">Connection Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dbt Cloud</span>
<span class="nt">Account ID</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">View in URL of https://cloud.getdbt.com/</span>
<span class="nt">API Token</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">View in https://cloud.getdbt.com/#/profile/api/</span>
</code></pre></div></p>
<ul>
<li>Transform</li>
</ul>
<p><div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>apache-airflow-providers-dbt-cloud<span class="o">==</span><span class="m">2</span>.1.0
</code></pre></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">airflow.providers.dbt.cloud.operators.dbt</span><span class="w"> </span><span class="kn">import</span> <span class="n">DbtCloudRunJobOperator</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">DbtCloudRunJobOperator</span><span class="p">(</span>
    <span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;transform&quot;</span><span class="p">,</span>
    <span class="n">job_id</span><span class="o">=</span><span class="mi">118680</span><span class="p">,</span>  <span class="c1"># Go to dbt UI &gt; click left menu &gt; Jobs &gt; Transform &gt; job_id in URL</span>
    <span class="n">wait_for_termination</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># wait for job to finish running</span>
    <span class="n">check_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>  <span class="c1"># check job status</span>
    <span class="n">timeout</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>  <span class="c1"># max time for job to execute</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
</div>
<h4 id="validate_1">Validate</h4>
<p>And of course, we'll want to validate our transformations beyond dbt's built-in methods, using great expectations. We'll create a suite and checkpoint as we did above for our projects and tags data assets.
<div class="highlight"><pre><span></span><code>great_expectations<span class="w"> </span>suite<span class="w"> </span>new<span class="w">  </span><span class="c1"># for mlops_course.labeled_projects</span>
</code></pre></div></p>
<details class="quote">
<summary>Expectations for <code>mlops_course.labeled_projects</code></summary>
<p>Table expectations
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># data leak</span>
<span class="n">validator</span><span class="o">.</span><span class="n">expect_compound_columns_to_be_unique</span><span class="p">(</span><span class="n">column_list</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">])</span>
</code></pre></div></td></tr></table></div></p>
<p>Column expectations:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># id</span>
<span class="n">validator</span><span class="o">.</span><span class="n">expect_column_values_to_be_unique</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>

<span class="c1"># create_on</span>
<span class="n">validator</span><span class="o">.</span><span class="n">expect_column_values_to_not_be_null</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;created_on&quot;</span><span class="p">)</span>

<span class="c1"># title</span>
<span class="n">validator</span><span class="o">.</span><span class="n">expect_column_values_to_not_be_null</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;title&quot;</span><span class="p">)</span>
<span class="n">validator</span><span class="o">.</span><span class="n">expect_column_values_to_be_of_type</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="s2">&quot;STRING&quot;</span><span class="p">)</span>

<span class="c1"># description</span>
<span class="n">validator</span><span class="o">.</span><span class="n">expect_column_values_to_not_be_null</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;description&quot;</span><span class="p">)</span>
<span class="n">validator</span><span class="o">.</span><span class="n">expect_column_values_to_be_of_type</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="s2">&quot;STRING&quot;</span><span class="p">)</span>

<span class="c1"># tag</span>
<span class="n">validator</span><span class="o">.</span><span class="n">expect_column_values_to_not_be_null</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;tag&quot;</span><span class="p">)</span>
<span class="n">validator</span><span class="o">.</span><span class="n">expect_column_values_to_be_of_type</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;tag&quot;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="s2">&quot;STRING&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
</details>
<p><div class="highlight"><pre><span></span><code>great_expectations<span class="w"> </span>checkpoint<span class="w"> </span>new<span class="w"> </span>labeled_projects
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nt">datasource_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dwh</span>
<span class="nt">data_asset_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mlops_course.labeled_projects</span>
<span class="nt">expectation_suite_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">labeled_projects</span>
</code></pre></div></p>
<p>and just like how we added the validation task for our extracted and loaded data, we can do the same for our transformed data in Airflow:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dag</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">dataops</span><span class="p">():</span>
    <span class="o">...</span>
    <span class="c1"># Transform</span>
    <span class="n">transform</span> <span class="o">=</span> <span class="n">BashOperator</span><span class="p">(</span><span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;transform&quot;</span><span class="p">,</span> <span class="n">bash_command</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;cd </span><span class="si">{</span><span class="n">DBT_ROOT_DIR</span><span class="si">}</span><span class="s2"> &amp;&amp; dbt run &amp;&amp; dbt test&quot;</span><span class="p">)</span>
    <span class="n">validate_transforms</span> <span class="o">=</span> <span class="n">GreatExpectationsOperator</span><span class="p">(</span>
        <span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;validate_transforms&quot;</span><span class="p">,</span>
        <span class="n">checkpoint_name</span><span class="o">=</span><span class="s2">&quot;labeled_projects&quot;</span><span class="p">,</span>
        <span class="n">data_context_root_dir</span><span class="o">=</span><span class="n">GE_ROOT_DIR</span><span class="p">,</span>
        <span class="n">fail_task_on_validation_failure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Define DAG</span>
    <span class="n">extract_and_load_projects</span> <span class="o">&gt;&gt;</span> <span class="n">validate_projects</span>
    <span class="n">extract_and_load_tags</span> <span class="o">&gt;&gt;</span> <span class="n">validate_tags</span>
    <span class="p">[</span><span class="n">validate_projects</span><span class="p">,</span> <span class="n">validate_tags</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">transform</span> <span class="o">&gt;&gt;</span> <span class="n">validate_transforms</span>
</code></pre></div></td></tr></table></div>
<hr>

<p>Now we have our entire DataOps DAG define and executing it will prepare our data from extraction to loading to transformation (and with validation at every step of the way) for <a href="../data-engineering/#applications" target="_blank">downstream applications</a>.</p>
<div class="ai-center-all">
    <img src="/static/images/mlops/orchestration/dataops.png" width="700" alt="dataops">
</div>

<blockquote>
<p>Typically we'll use <a href="https://airflow.apache.org/docs/apache-airflow/stable/_api/airflow/sensors/" target="_blank">sensors</a> to trigger workflows when a condition is met or trigger them directly from the external source via API calls, etc. For our ML use cases, this could be at regular intervals or when labeling or monitoring workflows trigger retraining, etc.</p>
</blockquote>
<h2 id="mlops">MLOps</h2>
<p>Once we have our data prepared, we're ready to create one of the many potential downstream applications that will depend on it. Let's head back to our <code>mlops-course</code> project and follow the same <a href="#set-up">set up instructions</a> for Airflow (you can stop the Airflow webserver and scheduler from our data-engineering project since we'll reuse PORT 8000).</p>
<div class="row">
    <div class="col-md-6">
<div class="highlight"><pre id="__code_2"><span></span><button class="md-clipboard md-icon" title="Copy to clipboard" data-clipboard-target="#__code_2 > code"></button><code tabindex="0"><span class="c1"># Airflow webserver</span>
<span class="nb">source</span> venv/bin/activate
<span class="nb">export</span> <span class="nv">AIRFLOW_HOME</span><span class="o">=</span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/airflow
<span class="nb">export</span> <span class="nv">GOOGLE_APPLICATION_CREDENTIALS</span><span class="o">=</span>/Users/goku/Downloads/made-with-ml-XXXXXX-XXXXXXXXXXXX.json <span class="c1"># REPLACE</span>
airflow webserver --port <span class="m">8080</span>
<span class="c1"># Go to http://localhost:8080</span>
</code></pre></div>
    </div>
    <div class="col-md-6">
<div class="highlight"><pre id="__code_3"><span></span><button class="md-clipboard md-icon" title="Copy to clipboard" data-clipboard-target="#__code_3 > code"></button><code tabindex="0"><span class="c1"># Airflow scheduler</span>
<span class="nb">source</span> venv/bin/activate
<span class="nb">export</span> <span class="nv">AIRFLOW_HOME</span><span class="o">=</span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/airflow
<span class="nb">export</span> <span class="nv">OBJC_DISABLE_INITIALIZE_FORK_SAFETY</span><span class="o">=</span>YES
<span class="nb">export</span> <span class="nv">GOOGLE_APPLICATION_CREDENTIALS</span><span class="o">=</span>~/Downloads/made-with-ml-XXXXXX-XXXXXXXXXXXX.json <span class="c1"># REPLACE</span>
airflow scheduler
</code></pre></div>
    </div>
</div>

<div class="highlight"><pre><span></span><code>touch<span class="w"> </span>airflow/dags/workflows.py
</code></pre></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># airflow/dags/workflows.py</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">airflow.decorators</span><span class="w"> </span><span class="kn">import</span> <span class="n">dag</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">airflow.utils.dates</span><span class="w"> </span><span class="kn">import</span> <span class="n">days_ago</span>

<span class="c1"># Default DAG args</span>
<span class="n">default_args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;airflow&quot;</span><span class="p">,</span>
    <span class="s2">&quot;catch_up&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">}</span>

<span class="nd">@dag</span><span class="p">(</span>
    <span class="n">dag_id</span><span class="o">=</span><span class="s2">&quot;mlops&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;MLOps tasks.&quot;</span><span class="p">,</span>
    <span class="n">default_args</span><span class="o">=</span><span class="n">default_args</span><span class="p">,</span>
    <span class="n">schedule_interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="n">days_ago</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mlops&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mlops</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;MLOps workflows.&quot;&quot;&quot;</span>
    <span class="k">pass</span>

<span class="c1"># Run DAG</span>
<span class="n">ml</span> <span class="o">=</span> <span class="n">mlops</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<h3 id="dataset">Dataset</h3>
<p>We already had an <code>tagifai.elt_data</code> function defined to prepare our data but if we want to leverage the data inside our data warehouse, we'll want to connect to it.</p>
<div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>google-cloud-bigquery<span class="o">==</span><span class="m">1</span>.21.0
</code></pre></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># airflow/dags/workflows.py</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">google.cloud</span><span class="w"> </span><span class="kn">import</span> <span class="n">bigquery</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">google.oauth2</span><span class="w"> </span><span class="kn">import</span> <span class="n">service_account</span>

<span class="n">PROJECT_ID</span> <span class="o">=</span> <span class="s2">&quot;made-with-ml-XXXXX&quot;</span> <span class="c1"># REPLACE</span>
<span class="n">SERVICE_ACCOUNT_KEY_JSON</span> <span class="o">=</span> <span class="s2">&quot;/Users/goku/Downloads/made-with-ml-XXXXXX-XXXXXXXXXXXX.json&quot;</span>  <span class="c1"># REPLACE</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_extract_from_dwh</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract labeled data from</span>
<span class="sd">    our BigQuery data warehouse and</span>
<span class="sd">    save it locally.&quot;&quot;&quot;</span>
    <span class="c1"># Establish connection to DWH</span>
    <span class="n">credentials</span> <span class="o">=</span> <span class="n">service_account</span><span class="o">.</span><span class="n">Credentials</span><span class="o">.</span><span class="n">from_service_account_file</span><span class="p">(</span><span class="n">SERVICE_ACCOUNT_KEY_JSON</span><span class="p">)</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">bigquery</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="n">PROJECT_ID</span><span class="p">)</span>

    <span class="c1"># Query data</span>
    <span class="n">query_job</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT *</span>
<span class="s2">        FROM mlops_course.labeled_projects&quot;&quot;&quot;</span><span class="p">)</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">query_job</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
    <span class="n">results</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="s2">&quot;labeled_projects.csv&quot;</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nd">@dag</span><span class="p">(</span>
    <span class="n">dag_id</span><span class="o">=</span><span class="s2">&quot;mlops&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;MLOps tasks.&quot;</span><span class="p">,</span>
    <span class="n">default_args</span><span class="o">=</span><span class="n">default_args</span><span class="p">,</span>
    <span class="n">schedule_interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="n">days_ago</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mlops&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mlops</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;MLOps workflows.&quot;&quot;&quot;</span>
    <span class="n">extract_from_dwh</span> <span class="o">=</span> <span class="n">PythonOperator</span><span class="p">(</span>
        <span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;extract_data&quot;</span><span class="p">,</span>
        <span class="n">python_callable</span><span class="o">=</span><span class="n">_extract_from_dwh</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Define DAG</span>
    <span class="n">extract_from_dwh</span>
</code></pre></div></td></tr></table></div>
<h3 id="validate_2">Validate</h3>
<p>Next, we'll use Great Expectations to validate our data. Even though we've already validated our data, it's a best practice to test for data quality whenever there is a hand-off of data from one place to another. We've already created a checkpoint for our <code>labeled_projects</code> in our <a href="../testing/#checkpoints" target="_blank">testing lesson</a> so we'll just leverage that inside our MLOps DAG.</p>
<div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>airflow-provider-great-expectations<span class="o">==</span><span class="m">0</span>.1.1<span class="w"> </span>great-expectations<span class="o">==</span><span class="m">0</span>.15.19
</code></pre></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">great_expectations_provider.operators.great_expectations</span><span class="w"> </span><span class="kn">import</span> <span class="n">GreatExpectationsOperator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">config</span><span class="w"> </span><span class="kn">import</span> <span class="n">config</span>

<span class="n">GE_ROOT_DIR</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s2">&quot;tests&quot;</span><span class="p">,</span> <span class="s2">&quot;great_expectations&quot;</span><span class="p">)</span>

<span class="nd">@dag</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mlops</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;MLOps workflows.&quot;&quot;&quot;</span>
    <span class="n">extract_from_dwh</span> <span class="o">=</span> <span class="n">PythonOperator</span><span class="p">(</span>
        <span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;extract_data&quot;</span><span class="p">,</span>
        <span class="n">python_callable</span><span class="o">=</span><span class="n">_extract_from_dwh</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">validate</span> <span class="o">=</span> <span class="n">GreatExpectationsOperator</span><span class="p">(</span>
        <span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;validate&quot;</span><span class="p">,</span>
        <span class="n">checkpoint_name</span><span class="o">=</span><span class="s2">&quot;labeled_projects&quot;</span><span class="p">,</span>
        <span class="n">data_context_root_dir</span><span class="o">=</span><span class="n">GE_ROOT_DIR</span><span class="p">,</span>
        <span class="n">fail_task_on_validation_failure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Define DAG</span>
    <span class="n">extract_from_dwh</span> <span class="o">&gt;&gt;</span> <span class="n">validate</span>
</code></pre></div></td></tr></table></div>
<h3 id="train">Train</h3>
<p>Finally, we'll optimize and train a model using our validated data.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">airflow.operators.python_operator</span><span class="w"> </span><span class="kn">import</span> <span class="n">PythonOperator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">config</span><span class="w"> </span><span class="kn">import</span> <span class="n">config</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tagifai</span><span class="w"> </span><span class="kn">import</span> <span class="n">main</span>

<span class="nd">@dag</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mlops</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;MLOps workflows.&quot;&quot;&quot;</span>
    <span class="o">...</span>
    <span class="n">optimize</span> <span class="o">=</span> <span class="n">PythonOperator</span><span class="p">(</span>
        <span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;optimize&quot;</span><span class="p">,</span>
        <span class="n">python_callable</span><span class="o">=</span><span class="n">main</span><span class="o">.</span><span class="n">optimize</span><span class="p">,</span>
        <span class="n">op_kwargs</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;args_fp&quot;</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">CONFIG_DIR</span><span class="p">,</span> <span class="s2">&quot;args.json&quot;</span><span class="p">),</span>
            <span class="s2">&quot;study_name&quot;</span><span class="p">:</span> <span class="s2">&quot;optimization&quot;</span><span class="p">,</span>
            <span class="s2">&quot;num_trials&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">)</span>
    <span class="n">train</span> <span class="o">=</span> <span class="n">PythonOperator</span><span class="p">(</span>
        <span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span>
        <span class="n">python_callable</span><span class="o">=</span><span class="n">main</span><span class="o">.</span><span class="n">train_model</span><span class="p">,</span>
        <span class="n">op_kwargs</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;args_fp&quot;</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">CONFIG_DIR</span><span class="p">,</span> <span class="s2">&quot;args.json&quot;</span><span class="p">),</span>
            <span class="s2">&quot;experiment_name&quot;</span><span class="p">:</span> <span class="s2">&quot;baselines&quot;</span><span class="p">,</span>
            <span class="s2">&quot;run_name&quot;</span><span class="p">:</span> <span class="s2">&quot;sgd&quot;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
<hr>

<p>And with that we have our MLOps workflow defined that uses the prepared data from our DataOps workflow. At this point, we can add additional tasks for offline/online evaluation, deployment, etc. with the same process as above.</p>
<div class="ai-center-all">
    <img src="/static/images/mlops/orchestration/mlops.png" width="700" alt="mlops">
</div>

<h2 id="continual-learning">Continual learning</h2>
<p>The DataOps and MLOps workflows connect to create an ML system that's capable of continually learning. Such a system will guide us with when to update, what exactly to update and how to update it (easily).</p>
<blockquote>
<p>We use the word continual (repeat with breaks) instead of continuous (repeat without interruption / intervention) because we're not trying to create a system that will automatically update with new incoming data without human intervention.</p>
</blockquote>
<h3 id="monitoring">Monitoring</h3>
<p>Our production system is live and <a href="../monitoring/" target="_blank">monitored</a>. When an event of interest occurs (ex. <a href="../monitoring/#drift" target="_blank">drift</a>), one of several events needs to be triggered:</p>
<ul>
<li><code class="highlight"><span class="k">continue</span></code>: with the currently deployed model without any updates. However, an alert was raised so it should analyzed later to reduce false positive alerts.</li>
<li><code class="highlight"><span class="nx">improve</span></code>: by retraining the model to avoid performance degradation causes by meaningful drift (data, target, concept, etc.).</li>
<li><code class="highlight"><span class="nx">inspect</span></code>: to make a decision. Typically expectations are reassessed, schemas are reevaluated for changes, slices are reevaluated, etc.</li>
<li><code class="highlight"><span class="nx">rollback</span></code>: to a previous version of the model because of an issue with the current deployment. Typically these can be avoided using robust deployment strategies (ex. dark canary).</li>
</ul>
<h3 id="retraining">Retraining</h3>
<p>If we need to improve on the existing version of the model, it's not just the matter of fact of rerunning the model creation workflow on the new dataset. We need to carefully compose the training data in order to avoid issues such as catastrophic forgetting (forget previously learned patterns when presented with new data).</p>
<ul>
<li><code class="highlight"><span class="nx">labeling</span></code>: new incoming data may need to be properly labeled before being used (we cannot just depend on proxy labels).</li>
<li><code class="highlight"><span class="nx">active</span><span class="w"> </span><span class="nx">learning</span></code>: we may not be able to explicitly label every single new data point so we have to leverage <a href="../labeling/#active-learning" target="_blank">active learning</a> workflows to complete the labeling process.</li>
<li><code class="highlight"><span class="nx">QA</span></code>: quality assurance workflows to ensure that labeling is accurate, especially for known false positives/negatives and historically poorly performing slices of data.</li>
<li><code class="highlight"><span class="nx">augmentation</span></code>: increasing our training set with <a href="../augmentation/" target="_blank">augmented data</a> that's representative of the original dataset.</li>
<li><code class="highlight"><span class="nx">sampling</span></code>: upsampling and downsampling to address imbalanced data slices.</li>
<li><code class="highlight"><span class="nx">evaluation</span></code>:  creation of an evaluation dataset that's representative of what the model will encounter once deployed.</li>
</ul>
<p>Once we have the proper dataset for retraining, we can kickoff the workflows to update our system!</p>
<!-- Course signup -->
<hr style="margin-top: 2.25rem; margin-bottom: 2.25rem;">

<div class="admonition question mx-md-5">
<p class="admonition-title">Upcoming live cohorts</p>
<p>Sign up for our upcoming live cohort, where we'll provide <b>live lessons + QA</b>, <b>compute (GPUs)</b> and <b>community</b> to learn everything in one day.
<script src="//embed.typeform.com/next/embed.js"></script>
</p><div class="ai-center-all mb-3">
    <button data-tf-popup="hFw8rLTJ" data-tf-opacity="100" data-tf-size="100" data-tf-iframe-props="title=Made With ML" data-tf-transitive-search-params data-tf-medium="snippet" data-tf-hidden="utm_source="class="md-button md-button--green-gradient mb-2 mb-md-0 mt-md-0 mt-1" style="cursor: pointer !important;"><span class="twemoji mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M20.322.75a10.75 10.75 0 00-7.373 2.926l-1.304 1.23A23.743 23.743 0 0010.103 6.5H5.066a1.75 1.75 0 00-1.5.85l-2.71 4.514a.75.75 0 00.49 1.12l4.571.963c.039.049.082.096.129.14L8.04 15.96l1.872 1.994c.044.047.091.09.14.129l.963 4.572a.75.75 0 001.12.488l4.514-2.709a1.75 1.75 0 00.85-1.5v-5.038a23.741 23.741 0 001.596-1.542l1.228-1.304a10.75 10.75 0 002.925-7.374V2.499A1.75 1.75 0 0021.498.75h-1.177zM16 15.112c-.333.248-.672.487-1.018.718l-3.393 2.262.678 3.223 3.612-2.167a.25.25 0 00.121-.214v-3.822zm-10.092-2.7L8.17 9.017c.23-.346.47-.685.717-1.017H5.066a.25.25 0 00-.214.121l-2.167 3.612 3.223.679zm8.07-7.644a9.25 9.25 0 016.344-2.518h1.177a.25.25 0 01.25.25v1.176a9.25 9.25 0 01-2.517 6.346l-1.228 1.303a22.248 22.248 0 01-3.854 3.257l-3.288 2.192-1.743-1.858a.764.764 0 00-.034-.034l-1.859-1.744 2.193-3.29a22.248 22.248 0 013.255-3.851l1.304-1.23zM17.5 8a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zm-11 13c.9-.9.9-2.6 0-3.5-.9-.9-2.6-.9-3.5 0-1.209 1.209-1.445 3.901-1.49 4.743a.232.232 0 00.247.247c.842-.045 3.534-.281 4.743-1.49z"></path></svg></span> Learn more</a>
</div><p></p>
</div>

<!-- Citation -->
<hr style="margin-top: 2.25rem; margin-bottom: 2.25rem;">

<p>To cite this content, please use:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nc">@article</span><span class="p">{</span><span class="nl">madewithml</span><span class="p">,</span>
<span class="w">    </span><span class="na">author</span><span class="w">       </span><span class="p">=</span><span class="w"> </span><span class="s">{Goku Mohandas}</span><span class="p">,</span>
<span class="w">    </span><span class="na">title</span><span class="w">        </span><span class="p">=</span><span class="w"> </span><span class="s">{ Orchestration for Machine Learning - Made With ML }</span><span class="p">,</span>
<span class="w">    </span><span class="na">howpublished</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">{\url{https://madewithml.com/}}</span><span class="p">,</span>
<span class="w">    </span><span class="na">year</span><span class="w">         </span><span class="p">=</span><span class="w"> </span><span class="s">{2023}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
  
    
  
  <br>

              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      <div style="display:flex; flex-direction:column;"><a href="https://www.anyscale.com?utm_source=madewithmml&utm_medium=website&utm_campaign=footer" target="_blank"><img src="/static/images/anyscale-white-text.svg" style="width: 4rem;"></a> © 2025 Anyscale, Inc. <br> <a href="https://www.anyscale.com/privacy-policy" target="_blank">Anyscale Privacy Policy</a></div>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/GokuMohandas" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://linkedin.com/in/goku" target="_blank" rel="noopener" title="linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/GokuMohandas" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/madewithml?sub_confirmation=1" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:goku@madewithml.com" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480v-83.6c0-4 1.5-7.8 4.2-10.7l167.6-182.9c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8l-88.3-44.2C7.1 311.3.3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "content.tabs.link"], "search": "../../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
     

      <script src="../../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
        
          <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
        
      
        
          <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
        
      
        
          <script src="https://cdnjs.cloudflare.com/ajax/libs/tablesort/5.2.1/tablesort.min.js"></script>
        
      
        
          <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        
      
        
          <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
      
        
          <script src="../../../static/js/custom.js"></script>
        
      
        
          <script src="../../../static/js/termynal.js"></script>
        
      
    

<!-- Google Tag Manager (noscript) -->
<noscript>
  <iframe
    src="https://www.googletagmanager.com/ns.html?id=GTM-P8H6KQG"
    height="0"
    width="0"
    style="display: none; visibility: hidden"
  ></iframe>
</noscript>
<!-- End Google Tag Manager (noscript) -->


  </body>
</html>